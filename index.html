<!DOCTYPE html>
<html lang="nl"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1">
    <title>Zanes Startseite</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: radial-gradient(ellipse at center, #2d2d2d 0%, #1a1a1a 50%, #0d0d0d 100%);
            min-height: 100vh;
            color: #e0e0e0;
            overflow-x: hidden;
            position: relative;
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            min-height: 100vh;
            min-height: -webkit-fill-available;
            pointer-events: none;
            z-index: 1;
            background: radial-gradient(ellipse at center,
                rgba(25, 25, 60, 0.3) 0%,
                rgba(15, 15, 35, 0.6) 40%,
                rgba(5, 5, 15, 0.9) 100%);
            overscroll-behavior: none;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            animation: twinkle 4s infinite ease-in-out;
        }

        .particle.star {
            background: radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.8) 30%, transparent 70%);
            box-shadow: 0 0 6px rgba(255, 255, 255, 0.8), 0 0 12px rgba(255, 255, 255, 0.4);
        }

        .particle.blue-star {
            background: radial-gradient(circle, rgba(150, 200, 255, 1) 0%, rgba(150, 200, 255, 0.8) 30%, transparent 70%);
            box-shadow: 0 0 8px rgba(150, 200, 255, 0.8), 0 0 16px rgba(150, 200, 255, 0.3);
        }

        .particle.distant-star {
            background: radial-gradient(circle, rgba(255, 255, 255, 0.6) 0%, rgba(255, 255, 255, 0.3) 50%, transparent 100%);
            box-shadow: 0 0 2px rgba(255, 255, 255, 0.4);
        }

        .particle.shooting-star {
            background: linear-gradient(45deg, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.8) 60%, transparent 100%);
            border-radius: 50% 0% 50% 0%;
            animation: shootingStar 3s linear infinite;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.8), 0 0 20px rgba(255, 255, 255, 0.4);
        }

        @keyframes twinkle {
            0%, 100% { 
                opacity: 0.3; 
                transform: scale(1); 
            }
            50% { 
                opacity: 1; 
                transform: scale(1.4); 
            }
        }

        @keyframes shootingStar {
            0% {
                transform: translateX(-100px) translateY(100px) rotate(45deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateX(calc(100vw + 100px)) translateY(-100px) rotate(45deg);
                opacity: 0;
            }
        }

        .container {
            position: relative;
            z-index: 2;
            max-width: 1000px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .logo {
            font-size: 3rem;
            font-weight: 200;
            color: #ffffff;
            margin-bottom: 2rem;
            letter-spacing: -2px;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
            min-height: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.2;
        }

        .typewriter-container {
            position: relative;
            display: inline-block;
        }

        .typewriter-text {
            display: inline-block;
            white-space: nowrap;
            overflow: hidden;
            border-right: none;
            line-height: 1.2;
        }

        .typewriter-cursor {
            display: inline-block;
            width: 2px;
            height: 1.2em;
            background-color: rgba(255, 255, 255, 0.8);
            animation: blinkCursor 1s infinite;
            margin-left: 2px;
            vertical-align: baseline;
        }

        @keyframes blinkCursor {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .search-container {
            position: relative;
            max-width: 700px;
            margin: 0 auto;
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .search-wrapper {
            flex: 1;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 1.2rem 1.8rem;
            padding-right: 3.5rem;
            font-size: 1.1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            background: rgba(0, 0, 0, 0.25);
            backdrop-filter: blur(5px);
            color: #ffffff;
            transition: all 0.3s ease;
            outline: none;
        }

        .search-selector {
            position: relative;
            min-width: 140px;
        }

        .search-select {
            width: 100%;
            padding: 1.2rem 1rem;
            font-size: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            background: rgba(0, 0, 0, 0.25);
            backdrop-filter: blur(5px);
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            outline: none;
            appearance: none;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .search-select:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.15), 0 0 60px rgba(255, 255, 255, 0.08);
            transform: translateY(-1px);
        }

        .search-select:active {
            transform: translateY(0) scale(0.98);
            transition: transform 0.1s ease;
        }

        .search-engine-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 0.5rem 0;
            margin-top: 0.5rem;
            display: block;
            opacity: 0;
            transform: translateY(-10px) scaleY(0.8);
            transform-origin: top;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            max-height: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .search-engine-dropdown.show {
            opacity: 1;
            transform: translateY(0) scaleY(1);
            max-height: 300px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            pointer-events: auto;
        }

        .search-engine-dropdown.show .search-engine-option {
            animation: fadeInUp 0.3s ease forwards;
            opacity: 0;
            transform: translateY(10px);
        }

        .search-engine-dropdown.show .search-engine-option:nth-child(1) { animation-delay: 0.05s; }
        .search-engine-dropdown.show .search-engine-option:nth-child(2) { animation-delay: 0.1s; }
        .search-engine-dropdown.show .search-engine-option:nth-child(3) { animation-delay: 0.15s; }
        .search-engine-dropdown.show .search-engine-option:nth-child(4) { animation-delay: 0.2s; }
        .search-engine-dropdown.show .search-engine-option:nth-child(5) { animation-delay: 0.25s; }
        .search-engine-dropdown.show .search-engine-option:nth-child(6) { animation-delay: 0.3s; }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .search-engine-option {
            padding: 0.8rem 1rem;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .search-engine-option:hover {
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
            transform: translateY(0);
            border-radius: 0;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .search-input:focus {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(0, 0, 0, 0.6);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.15), 0 0 60px rgba(255, 255, 255, 0.05);
        }

        .search-select:focus {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(0, 0, 0, 0.6);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.15), 0 0 60px rgba(255, 255, 255, 0.05);
        }

        .search-button {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(8px);
            color: #ffffff;
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 0.6rem;
            border-radius: 50%;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            width: 40px;
            height: 40px;
            overflow: hidden;
            flex-shrink: 0;
        }

        .search-button .search-icon-svg {
            width: 20px;
            height: 20px;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .search-button .search-text {
            opacity: 0;
            transform: translateX(5px);
            transition: all 0.3s ease;
            white-space: nowrap;
            font-size: 0.9rem;
            position: absolute;
            left: 50%;
            transform: translateX(-50%) translateX(5px);
        }

        .search-button:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            width: 90px;
            padding: 0.6rem 1.2rem;
            box-shadow: 0 0 35px rgba(255, 255, 255, 0.2), 0 0 70px rgba(255, 255, 255, 0.1);
        }

        .search-button:hover .search-icon-svg {
            opacity: 0;
            transform: translateX(-10px);
        }

        .search-button:hover .search-text {
            opacity: 1;
            transform: translateX(-50%) translateX(0);
        }

        .search-select:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.15), 0 0 60px rgba(255, 255, 255, 0.08);
        }

        .bookmarks {
            margin-top: 4rem;
        }

        .bookmark-section {
            background: rgba(0, 0, 0, 0.25);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }

        .bookmark-section:hover {
            background: rgba(0, 0, 0, 0.5);
            border-color: rgba(255, 255, 255, 0.15);
        }

        .section-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .rename-section, .delete-section {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(4px);
            color: rgba(255, 255, 255, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .rename-section:hover {
            background: rgba(255, 255, 255, 0.15);
            color: #ffffff;
        }

        .delete-section {
            background: rgba(255, 50, 50, 0.08);
        }

        .delete-section:hover {
            background: rgba(255, 50, 50, 0.2);
            color: #ffffff;
        }

        .add-section {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(4px);
            color: #ffffff;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 1rem 2rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            margin: 2rem auto;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            min-width: 200px;
            position: relative;
            overflow: hidden;
        }

        .add-section .plus-icon {
            width: 20px;
            height: 20px;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .add-section .add-text {
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .add-section .plus-icon {
            width: 20px;
            height: 20px;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .add-section .add-text {
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .add-section:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 300;
            color: #ffffff;
            letter-spacing: -0.5px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: calc(100% - 120px);
        }

        .add-bookmark {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 0.5rem;
            border-radius: 50%;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            position: relative;
            overflow: hidden;
        }

        .add-bookmark .plus-icon {
            width: 16px;
            height: 16px;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .add-bookmark .add-text {
            opacity: 0;
            transform: translateX(5px);
            transition: all 0.3s ease;
            font-size: 0.85rem;
            white-space: nowrap;
            position: absolute;
            left: 50%;
            transform: translateX(-50%) translateX(5px);
        }

        .add-bookmark:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            width: 90px;
            padding: 0.5rem 1rem;
            box-shadow: 0 0 35px rgba(255, 255, 255, 0.2), 0 0 70px rgba(255, 255, 255, 0.1);
        }

        .add-bookmark:hover .plus-icon {
            opacity: 0;
            transform: translateX(-10px);
        }

        .add-bookmark:hover .add-text {
            opacity: 1;
            transform: translateX(-50%) translateX(0);
        }

        .bookmark-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .bookmark-item {
            display: flex;
            align-items: center;
            padding: 1.2rem;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            text-decoration: none;
            color: #e0e0e0;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
            touch-action: manipulation; /* Better for mobile */
            -webkit-tap-highlight-color: transparent; /* Remove tap highlight on iOS */
        }

        .bookmark-item.dragging {
            opacity: 0.7;
            transform: rotate(2deg) scale(1.02);
            z-index: 1000;
            pointer-events: none;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
        }

        .bookmark-item.drag-target {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.02);
        }

        .bookmark-item:hover:not(.dragging) {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-4px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4), 0 0 50px rgba(255, 255, 255, 0.1);
        }

        .bookmark-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 255, 255, 0.1));
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            color: #ffffff;
            font-weight: 600;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .bookmark-info {
            flex: 1;
        }

        .bookmark-info h3 {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 0.3rem;
            color: #ffffff;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: calc(100% - 20px);
            display: block;
            width: 100%;
        }

        .bookmark-info {
            flex: 1;
            min-width: 0; /* Critical for flexbox truncation */
            overflow: hidden;
        }

        .bookmark-info h3.bookmark-title {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 0.3rem;
            color: #ffffff;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            display: block;
            width: 100%;
            cursor: default;
            max-width: 100%;
            box-sizing: border-box;
        }

        .bookmark-info p.bookmark-desc {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            display: block;
            width: 100%;
            cursor: default;
            max-width: 100%;
            box-sizing: border-box;
        }

        /* Enhanced tooltip styling */
        .bookmark-title[title]:hover,
        .bookmark-desc[title]:hover {
            cursor: help;
        }

        /* Ensure tooltips work on mobile */
        @media (hover: none) {
            .bookmark-title[title],
            .bookmark-desc[title] {
                cursor: default;
            }
        }

        .remove-bookmark {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            padding: 0;
        }

        .remove-bookmark .delete-icon {
            width: 14px;
            height: 14px;
            fill: rgba(255, 255, 255, 0.7);
            transition: all 0.3s ease;
        }

        .bookmark-item:hover .remove-bookmark {
            display: flex;
        }

        .remove-bookmark:hover {
            background: rgba(255, 50, 50, 0.4);
            box-shadow: 0 0 20px rgba(255, 50, 50, 0.3);
        }

        .remove-bookmark:hover .delete-icon {
            fill: #ffffff;
        }

        .modal {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0);
            backdrop-filter: blur(0px);
            z-index: 99999; /* Maximum z-index to ensure top layer */
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none; /* Prevent interaction when hidden */
            isolation: isolate; /* Create new stacking context */
            transform: scale(0.9);
            visibility: visible;
            overscroll-behavior: contain;
        }
        
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            z-index: 99998; /* Just below modal */
            display: none;
            overscroll-behavior: contain;
        }

        .modal.show {
            opacity: 1;
            pointer-events: auto; /* Enable interaction when visible */
            transform: scale(1);
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
        }
        
        /* Prevent background interaction when any modal is open */
        body.modal-open {
            overflow: hidden;
            pointer-events: none;
        }
        
        body.modal-open .modal {
            pointer-events: auto;
        }
        
        body.modal-open .modal * {
            pointer-events: auto;
        }

        .modal-content {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 25px;
            padding: 2.375rem; /* 5% reduction from 2.5rem */
            max-width: 475px; /* 5% reduction from 500px */
            width: 90%;
            transform: scale(0.9) translateY(20px); /* Start smaller and slightly lower */
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.045rem; /* 5% reduction from 1.1rem */
            position: relative;
            z-index: 100000; /* Ensure content is above modal background */
            opacity: 0;
        }

        .modal.show .modal-content {
            transform: scale(0.95) translateY(0); /* End at 95% scale and centered */
            opacity: 1;
        }

        .modal h3 {
            color: #ffffff;
            margin-bottom: 1.71rem; /* 5% reduction from 1.8rem */
            font-weight: 300;
            font-size: 1.33rem; /* 5% reduction from 1.4rem */
        }

        .modal input {
            width: 100%;
            padding: 0.855rem; /* 5% reduction from 0.9rem */
            margin-bottom: 1.14rem; /* 5% reduction from 1.2rem */
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            color: #ffffff;
            outline: none;
            font-size: 1.045rem; /* 5% reduction from 1.1rem */
        }

        .modal input::placeholder {
            color: rgba(255, 255, 255, 0.5);
            font-size: 1.045rem; /* 5% reduction from 1.1rem */
        }

        .modal input:focus {
            border-color: rgba(255, 255, 255, 0.4);
            background: rgba(0, 0, 0, 0.6);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.15), 0 0 60px rgba(255, 255, 255, 0.05);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-buttons {
            display: flex;
            gap: 1.14rem; /* 5% reduction from 1.2rem */
            justify-content: flex-end;
            margin-top: 1.425rem; /* 5% reduction from 1.5rem */
        }

        .modal button {
            padding: 0.76rem 1.425rem; /* 5% reduction from 0.8rem 1.5rem */
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(2px);
            color: #ffffff;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.045rem; /* 5% reduction from 1.1rem */
        }

        .modal button:hover {
            background: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.15);
        }

        .modal button.cancel:hover {
            background: rgba(255, 50, 50, 0.3);
            box-shadow: 0 0 25px rgba(255, 50, 50, 0.2);
        }

        .modal button.cancel {
            background: rgba(255, 50, 50, 0.2);
        }

        /* Language Menu Button */
        .language-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .language-btn {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            color: #ffffff;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(4px);
            position: relative;
            overflow: hidden;
        }

        .language-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.15);
            transform: translateY(-1px);
        }

        .language-btn:active {
            transform: translateY(0) scale(0.98);
            transition: transform 0.1s ease;
        }

        /* Enhanced button press feedback - simplified hover */
        .search-engine-option,
        .language-option {
            position: relative;
            overflow: hidden;
        }

        .search-engine-option:active,
        .language-option:active {
            transform: scale(0.98);
            transition: transform 0.1s ease;
        }

        .language-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 0.5rem 0;
            margin-top: 0.5rem;
            min-width: 150px;
            display: block;
            opacity: 0;
            transform: translateY(-10px) scaleY(0.8);
            transform-origin: top;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            max-height: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .language-dropdown.show {
            opacity: 1;
            transform: translateY(0) scaleY(1);
            max-height: 400px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
            pointer-events: auto;
        }

        .language-dropdown.show .language-option {
            animation: fadeInUp 0.3s ease forwards;
            opacity: 0;
            transform: translateY(10px);
        }

        .language-dropdown.show .language-option:nth-child(1) { animation-delay: 0.05s; }
        .language-dropdown.show .language-option:nth-child(2) { animation-delay: 0.1s; }
        .language-dropdown.show .language-option:nth-child(3) { animation-delay: 0.15s; }
        .language-dropdown.show .language-option:nth-child(4) { animation-delay: 0.2s; }
        .language-dropdown.show .language-option:nth-child(5) { animation-delay: 0.25s; }
        .language-dropdown.show .language-option:nth-child(6) { animation-delay: 0.3s; }
        .language-dropdown.show .language-option:nth-child(7) { animation-delay: 0.35s; }
        .language-dropdown.show .language-option:nth-child(8) { animation-delay: 0.4s; }

        .language-option {
            padding: 0.5rem 1rem;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .language-option:hover {
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
            transform: translateY(0);
            border-radius: 0;
        }
        /* Icon styles */
        .delete-icon, .edit-icon {
            width: 16px;
            height: 16px;
            vertical-align: middle;
            pointer-events: none;
        }

        .delete-section, .rename-section {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.3rem 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            position: relative;
            z-index: 10;
            min-width: 32px;
            min-height: 32px;
        }

        .delete-section {
            background: rgba(255, 50, 50, 0.08);
        }

        .rename-section {
            background: rgba(255, 255, 255, 0.08);
            color: rgba(255, 255, 255, 0.7);
        }

        .delete-section:hover {
            background: rgba(255, 50, 50, 0.2);
            border-color: rgba(255, 50, 50, 0.3);
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 50, 50, 0.3);
        }

        .rename-section:hover {
            background: rgba(255, 255, 255, 0.15);
            color: #ffffff;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.2);
        }

        @media (max-width: 600px) {
        .container {
            padding: 1rem 0.5rem;
        }

        .logo {
            font-size: 2rem;
        }

        .search-container {
            flex-direction: column;
            gap: 0.5rem;
        }

        .search-input {
            font-size: 1rem;
            padding: 1rem 1.2rem;
        }

        .search-select {
            font-size: 1rem;
            width: 100%;
            max-width: 300px;
        }

        .bookmark-grid {
            grid-template-columns: 1fr;
        }

        .bookmark-item {
            padding: 1rem;
        }

        .bookmark-icon {
            width: 40px;
            height: 40px;
            font-size: 1rem;
        }
    }

    </style>
    <style>
        /* Additional mobile fixes for overscroll and flash issues */
        html {
            overscroll-behavior: none;
            -webkit-overflow-scrolling: touch;
            height: 100%;
        }
        
        body {
            min-height: 100vh;
            min-height: -webkit-fill-available;
            background-attachment: fixed;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        
        /* Prevent white flash on mobile overscroll */
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* Ensure modal backdrop covers viewport properly */
        .modal.show {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }
    </style>
<!-- SVG Icons -->
<style>
                @keyframes spin {
                    0% { transform: translateY(-50%) rotate(0deg); }
                    100% { transform: translateY(-50%) rotate(360deg); }
                }
            </style></head><body class=""><svg style="display: none;">
    <defs>
        <symbol id="delete-icon" viewBox="0 0 24 24">
            <path d="M13.414,12l3.293-3.293a1,1,0,1,0-1.414-1.414L12,10.586,8.707,7.293A1,1,0,1,0,7.293,8.707L10.586,12,7.293,15.293a1,1,0,1,0,1.414,1.414L12,13.414l3.293,3.293a1,1,0,0,0,1.414-1.414Z" fill="#ffffff" transform="scale(1.15) translate(-1.5, -1.5)"></path>
        </symbol>
        <symbol id="edit-icon" viewBox="0 0 24 24">
            <path clip-rule="evenodd" d="M15.2929 5.12132C15.6834 4.7308 16.3166 4.7308 16.7071 5.12132L18.8787 7.29289C19.2692 7.68342 19.2692 8.31658 18.8787 8.70711L17 10.5858L13.4142 7L15.2929 5.12132ZM12 8.41421L4.29289 16.1213C4.10536 16.3089 4 16.5632 4 16.8284V20H7.17157C7.43679 20 7.69114 19.8946 7.87868 19.7071L15.5858 12L12 8.41421ZM18.1213 3.70711C16.9497 2.53553 15.0502 2.53554 13.8787 3.70711L2.87868 14.7071C2.31607 15.2697 2 16.0328 2 16.8284V20C2 21.1046 2.89543 22 4 22H7.17157C7.96722 22 8.73028 21.6839 9.29289 21.1213L20.2929 10.1213C21.4645 8.94975 21.4645 7.05025 20.2929 5.87868L18.1213 3.70711Z" fill="#ffffff" fill-rule="evenodd"></path>
        </symbol>
        <symbol id="plus-icon" viewBox="0 0 20 20">
            <path d="M10.5 2.75C10.5 2.33579 10.1642 2 9.75 2C9.33579 2 9 2.33579 9 2.75V9H2.75C2.33579 9 2 9.33579 2 9.75C2 10.1642 2.33579 10.5 2.75 10.5H9V16.75C9 17.1642 9.33579 17.5 9.75 17.5C10.1642 17.5 10.5 17.1642 10.5 16.75V10.5H16.75C17.1642 10.5 17.5 10.1642 17.5 9.75C17.5 9.33579 17.1642 9 16.75 9H10.5V2.75Z" fill="#ffffff" stroke="#ffffff" stroke-width="0.5"></path>
        </symbol>
        <symbol id="search-icon" viewBox="0 0 512 512">
            <path d="M445,386.7l-84.8-85.9c13.8-24.1,21-50.9,21-77.9c0-87.6-71.2-158.9-158.6-158.9C135.2,64,64,135.3,64,222.9  c0,87.6,71.2,158.9,158.6,158.9c27.9,0,55.5-7.7,80.1-22.4l84.4,85.6c1.9,1.9,4.6,3.1,7.3,3.1c2.7,0,5.4-1.1,7.3-3.1l43.3-43.8  C449,397.1,449,390.7,445,386.7z M222.6,125.9c53.4,0,96.8,43.5,96.8,97c0,53.5-43.4,97-96.8,97c-53.4,0-96.8-43.5-96.8-97  C125.8,169.4,169.2,125.9,222.6,125.9z" fill="#ffffff"></path>
        </symbol>
    </defs>
</svg>
    

    <div class="language-menu">
        <button class="language-btn" id="languageBtn">Meer</button>
        <div class="language-dropdown" id="languageDropdown" style="display: none;">
            <div class="language-option" data-lang="de">Deutsch</div>
            <div class="language-option" data-lang="nl">Nederlands</div>
            <div class="language-option" data-lang="gsw">Schweizerdeutsch</div>
            <div class="language-option" data-lang="fi">Suomi</div>
            <div class="language-option" data-lang="fr">Français</div>
            <div class="language-option" data-lang="en">English</div>
            <div class="language-option" data-lang="zh">简体中文</div>
            <div class="language-option" data-lang="ja">日本語</div>
        </div>
    </div>

    <div class="particles" id="particles"><div class="particle blue-star" style="width: 1.28181px; height: 1.28181px; left: 26.8596%; top: 47.7704%; animation-delay: 1.93586s; animation-duration: 3.92483s;"></div><div class="particle star" style="width: 2.3011px; height: 2.3011px; left: 14.7749%; top: 39.478%; animation-delay: 1.83179s; animation-duration: 4.46783s;"></div><div class="particle distant-star" style="width: 1.43061px; height: 1.43061px; left: 22.8601%; top: 28.5028%; animation-delay: 2.15637s; animation-duration: 5.02819s;"></div><div class="particle star" style="width: 2.45641px; height: 2.45641px; left: 72.4063%; top: 0.565338%; animation-delay: 1.89441s; animation-duration: 5.69198s;"></div><div class="particle star" style="width: 2.80556px; height: 2.80556px; left: 76.6546%; top: 35.9389%; animation-delay: 1.63935s; animation-duration: 5.17537s;"></div><div class="particle star" style="width: 1.1474px; height: 1.1474px; left: 92.3302%; top: 42.8654%; animation-delay: 0.942087s; animation-duration: 3.19236s;"></div><div class="particle distant-star" style="width: 0.836371px; height: 0.836371px; left: 85.3369%; top: 28.6564%; animation-delay: 2.48625s; animation-duration: 5.06848s;"></div><div class="particle star" style="width: 2.53427px; height: 2.53427px; left: 34.6635%; top: 79.8725%; animation-delay: 0.0859559s; animation-duration: 4.60641s;"></div><div class="particle star" style="width: 2.87052px; height: 2.87052px; left: 60.7133%; top: 24.9822%; animation-delay: 2.2929s; animation-duration: 3.86306s;"></div><div class="particle blue-star" style="width: 2.09188px; height: 2.09188px; left: 6.52831%; top: 47.9829%; animation-delay: 3.24098s; animation-duration: 5.20211s;"></div><div class="particle star" style="width: 1.78979px; height: 1.78979px; left: 5.61626%; top: 7.28376%; animation-delay: 0.555907s; animation-duration: 4.50657s;"></div><div class="particle blue-star" style="width: 0.893374px; height: 0.893374px; left: 40.8317%; top: 53.2881%; animation-delay: 0.394455s; animation-duration: 4.04374s;"></div><div class="particle star" style="width: 2.69091px; height: 2.69091px; left: 22.1598%; top: 91.0549%; animation-delay: 2.22012s; animation-duration: 3.97595s;"></div><div class="particle star" style="width: 1.9615px; height: 1.9615px; left: 36.2855%; top: 5.01673%; animation-delay: 2.78412s; animation-duration: 3.54377s;"></div><div class="particle star" style="width: 2.65179px; height: 2.65179px; left: 72.1658%; top: 93.7467%; animation-delay: 2.15596s; animation-duration: 5.30579s;"></div><div class="particle star" style="width: 2.64332px; height: 2.64332px; left: 41.7225%; top: 45.4375%; animation-delay: 0.561059s; animation-duration: 3.60548s;"></div><div class="particle star" style="width: 1.13135px; height: 1.13135px; left: 97.9015%; top: 57.55%; animation-delay: 0.470004s; animation-duration: 5.01688s;"></div><div class="particle star" style="width: 1.40393px; height: 1.40393px; left: 88.9441%; top: 76.5124%; animation-delay: 0.65061s; animation-duration: 4.99302s;"></div><div class="particle star" style="width: 2.84131px; height: 2.84131px; left: 89.3252%; top: 8.93774%; animation-delay: 0.43445s; animation-duration: 3.77881s;"></div><div class="particle blue-star" style="width: 0.877px; height: 0.877px; left: 35.6149%; top: 13.5768%; animation-delay: 1.77417s; animation-duration: 4.95909s;"></div><div class="particle blue-star" style="width: 0.992652px; height: 0.992652px; left: 52.8741%; top: 49.4848%; animation-delay: 2.11122s; animation-duration: 4.89925s;"></div><div class="particle star" style="width: 2.37196px; height: 2.37196px; left: 72.1285%; top: 76.1678%; animation-delay: 2.64069s; animation-duration: 3.08913s;"></div><div class="particle blue-star" style="width: 1.11287px; height: 1.11287px; left: 14.5729%; top: 23.5662%; animation-delay: 3.64048s; animation-duration: 5.45614s;"></div><div class="particle star" style="width: 2.11856px; height: 2.11856px; left: 27.0254%; top: 99.9474%; animation-delay: 1.98512s; animation-duration: 3.58612s;"></div><div class="particle blue-star" style="width: 1.04029px; height: 1.04029px; left: 95.5352%; top: 50.5895%; animation-delay: 1.75338s; animation-duration: 4.2979s;"></div><div class="particle star" style="width: 1.23357px; height: 1.23357px; left: 24.028%; top: 34.005%; animation-delay: 3.13555s; animation-duration: 5.18636s;"></div><div class="particle star" style="width: 2.94228px; height: 2.94228px; left: 78.6904%; top: 69.079%; animation-delay: 3.20851s; animation-duration: 5.28115s;"></div><div class="particle blue-star" style="width: 1.53454px; height: 1.53454px; left: 83.9214%; top: 1.81986%; animation-delay: 0.802724s; animation-duration: 3.97267s;"></div><div class="particle blue-star" style="width: 1.78974px; height: 1.78974px; left: 70.3247%; top: 84.9162%; animation-delay: 0.795343s; animation-duration: 5.09236s;"></div><div class="particle star" style="width: 2.24116px; height: 2.24116px; left: 35.4923%; top: 90.6958%; animation-delay: 3.75242s; animation-duration: 5.41661s;"></div><div class="particle star" style="width: 2.99725px; height: 2.99725px; left: 43.3205%; top: 19.083%; animation-delay: 0.975984s; animation-duration: 3.80948s;"></div><div class="particle star" style="width: 1.43514px; height: 1.43514px; left: 21.7413%; top: 82.8167%; animation-delay: 1.78122s; animation-duration: 4.61899s;"></div><div class="particle star" style="width: 1.85405px; height: 1.85405px; left: 75.0863%; top: 5.69889%; animation-delay: 1.73508s; animation-duration: 4.55858s;"></div><div class="particle blue-star" style="width: 1.74293px; height: 1.74293px; left: 10.0576%; top: 83.1125%; animation-delay: 2.00068s; animation-duration: 4.93848s;"></div><div class="particle star" style="width: 1.37864px; height: 1.37864px; left: 68.6075%; top: 23.9402%; animation-delay: 3.38467s; animation-duration: 4.5128s;"></div><div class="particle star" style="width: 1.19875px; height: 1.19875px; left: 66.8275%; top: 52.2631%; animation-delay: 1.39218s; animation-duration: 5.76746s;"></div><div class="particle distant-star" style="width: 1.36634px; height: 1.36634px; left: 75.1846%; top: 54.9936%; animation-delay: 3.09693s; animation-duration: 4.20813s;"></div><div class="particle blue-star" style="width: 1.59457px; height: 1.59457px; left: 34.8684%; top: 98.7841%; animation-delay: 3.45306s; animation-duration: 5.53254s;"></div><div class="particle distant-star" style="width: 0.550451px; height: 0.550451px; left: 55.6614%; top: 69.0488%; animation-delay: 2.52629s; animation-duration: 5.66284s;"></div><div class="particle star" style="width: 1.53097px; height: 1.53097px; left: 44.0883%; top: 23.3772%; animation-delay: 1.42034s; animation-duration: 3.3322s;"></div><div class="particle star" style="width: 2.15061px; height: 2.15061px; left: 78.6646%; top: 47.204%; animation-delay: 0.727383s; animation-duration: 3.97372s;"></div><div class="particle star" style="width: 1.55521px; height: 1.55521px; left: 98.5144%; top: 20.6685%; animation-delay: 1.94254s; animation-duration: 4.83416s;"></div><div class="particle star" style="width: 1.29313px; height: 1.29313px; left: 60.9383%; top: 64.3514%; animation-delay: 1.23635s; animation-duration: 3.15461s;"></div><div class="particle star" style="width: 1.34316px; height: 1.34316px; left: 46.7857%; top: 66.0331%; animation-delay: 3.22874s; animation-duration: 3.18048s;"></div><div class="particle star" style="width: 1.72525px; height: 1.72525px; left: 20.5124%; top: 95.6864%; animation-delay: 3.12963s; animation-duration: 4.49178s;"></div><div class="particle star" style="width: 2.76588px; height: 2.76588px; left: 86.0537%; top: 32.3578%; animation-delay: 2.86242s; animation-duration: 4.18812s;"></div><div class="particle star" style="width: 2.72546px; height: 2.72546px; left: 3.92468%; top: 99.0127%; animation-delay: 3.76646s; animation-duration: 3.32485s;"></div><div class="particle star" style="width: 1.32358px; height: 1.32358px; left: 3.14967%; top: 31.703%; animation-delay: 2.84328s; animation-duration: 5.67462s;"></div><div class="particle blue-star" style="width: 1.95446px; height: 1.95446px; left: 48.1887%; top: 76.6114%; animation-delay: 1.40906s; animation-duration: 3.24412s;"></div><div class="particle distant-star" style="width: 1.38999px; height: 1.38999px; left: 96.3623%; top: 1.73667%; animation-delay: 3.73975s; animation-duration: 4.24667s;"></div><div class="particle star" style="width: 1.27185px; height: 1.27185px; left: 47.5204%; top: 93.3895%; animation-delay: 1.11808s; animation-duration: 3.82597s;"></div><div class="particle star" style="width: 2.57928px; height: 2.57928px; left: 57.1381%; top: 47.2862%; animation-delay: 3.41005s; animation-duration: 4.76328s;"></div><div class="particle distant-star" style="width: 1.25118px; height: 1.25118px; left: 90.3599%; top: 35.1147%; animation-delay: 0.366221s; animation-duration: 5.68018s;"></div><div class="particle star" style="width: 2.29242px; height: 2.29242px; left: 94.5977%; top: 30.2273%; animation-delay: 1.17603s; animation-duration: 5.57411s;"></div><div class="particle star" style="width: 1.37413px; height: 1.37413px; left: 41.6899%; top: 80.5034%; animation-delay: 2.28014s; animation-duration: 4.67287s;"></div><div class="particle star" style="width: 1.45747px; height: 1.45747px; left: 52.5658%; top: 55.6889%; animation-delay: 3.55966s; animation-duration: 4.73102s;"></div><div class="particle star" style="width: 2.65751px; height: 2.65751px; left: 3.33093%; top: 91.1814%; animation-delay: 1.12341s; animation-duration: 4.17598s;"></div><div class="particle distant-star" style="width: 1.03171px; height: 1.03171px; left: 91.0282%; top: 35.8455%; animation-delay: 0.807179s; animation-duration: 4.09808s;"></div><div class="particle distant-star" style="width: 1.03712px; height: 1.03712px; left: 91.5787%; top: 12.1474%; animation-delay: 1.39146s; animation-duration: 5.01331s;"></div><div class="particle star" style="width: 2.54954px; height: 2.54954px; left: 56.413%; top: 12.4619%; animation-delay: 3.18803s; animation-duration: 3.74261s;"></div><div class="particle star" style="width: 2.83021px; height: 2.83021px; left: 59.2629%; top: 84.7673%; animation-delay: 1.28699s; animation-duration: 3.9551s;"></div><div class="particle star" style="width: 1.11573px; height: 1.11573px; left: 19.1375%; top: 91.1292%; animation-delay: 1.27826s; animation-duration: 4.79885s;"></div><div class="particle star" style="width: 2.10993px; height: 2.10993px; left: 95.7452%; top: 92.7531%; animation-delay: 3.28415s; animation-duration: 4.63282s;"></div><div class="particle star" style="width: 1.32182px; height: 1.32182px; left: 84.9493%; top: 19.7405%; animation-delay: 2.60001s; animation-duration: 3.95081s;"></div><div class="particle blue-star" style="width: 1.13592px; height: 1.13592px; left: 71.9545%; top: 64.7544%; animation-delay: 3.96001s; animation-duration: 5.72147s;"></div><div class="particle star" style="width: 2.10383px; height: 2.10383px; left: 89.2964%; top: 16.5623%; animation-delay: 3.25545s; animation-duration: 5.78278s;"></div><div class="particle star" style="width: 1.61954px; height: 1.61954px; left: 60.2769%; top: 33.8696%; animation-delay: 1.17089s; animation-duration: 3.42681s;"></div><div class="particle star" style="width: 2.12274px; height: 2.12274px; left: 43.5459%; top: 55.5714%; animation-delay: 0.713465s; animation-duration: 3.17638s;"></div><div class="particle star" style="width: 1.99666px; height: 1.99666px; left: 41.4272%; top: 83.8457%; animation-delay: 3.78339s; animation-duration: 5.12423s;"></div><div class="particle star" style="width: 2.84887px; height: 2.84887px; left: 60.737%; top: 75.2438%; animation-delay: 1.37721s; animation-duration: 4.48438s;"></div><div class="particle star" style="width: 1.633px; height: 1.633px; left: 41.6691%; top: 22.3446%; animation-delay: 2.90971s; animation-duration: 3.19131s;"></div><div class="particle star" style="width: 1.72631px; height: 1.72631px; left: 31.0294%; top: 0.831688%; animation-delay: 3.50303s; animation-duration: 4.97547s;"></div><div class="particle blue-star" style="width: 1.01213px; height: 1.01213px; left: 10.7794%; top: 73.5065%; animation-delay: 2.04641s; animation-duration: 4.66535s;"></div><div class="particle distant-star" style="width: 0.536525px; height: 0.536525px; left: 23.1423%; top: 57.331%; animation-delay: 1.65721s; animation-duration: 3.84505s;"></div><div class="particle star" style="width: 2.27541px; height: 2.27541px; left: 13.0876%; top: 97.8163%; animation-delay: 0.336172s; animation-duration: 3.84984s;"></div><div class="particle star" style="width: 2.64648px; height: 2.64648px; left: 21.636%; top: 53.4435%; animation-delay: 3.40488s; animation-duration: 3.77608s;"></div><div class="particle star" style="width: 2.82315px; height: 2.82315px; left: 10.7979%; top: 10.947%; animation-delay: 0.0804596s; animation-duration: 4.21305s;"></div><div class="particle blue-star" style="width: 2.1136px; height: 2.1136px; left: 43.1842%; top: 20.3353%; animation-delay: 1.62972s; animation-duration: 3.37347s;"></div><div class="particle blue-star" style="width: 1.08294px; height: 1.08294px; left: 92.4743%; top: 99.2194%; animation-delay: 3.77416s; animation-duration: 5.17319s;"></div><div class="particle star" style="width: 2.98421px; height: 2.98421px; left: 50.9182%; top: 60.4443%; animation-delay: 3.16878s; animation-duration: 4.25645s;"></div><div class="particle star" style="width: 1.34592px; height: 1.34592px; left: 74.1822%; top: 24.5172%; animation-delay: 3.88342s; animation-duration: 4.50695s;"></div><div class="particle blue-star" style="width: 1.60169px; height: 1.60169px; left: 64.3395%; top: 75.6493%; animation-delay: 3.98714s; animation-duration: 4.33599s;"></div><div class="particle star" style="width: 1.21305px; height: 1.21305px; left: 7.34239%; top: 88.6628%; animation-delay: 0.408565s; animation-duration: 4.56532s;"></div><div class="particle star" style="width: 1.04435px; height: 1.04435px; left: 44.0327%; top: 49.4543%; animation-delay: 3.02797s; animation-duration: 5.75142s;"></div><div class="particle star" style="width: 1.94396px; height: 1.94396px; left: 52.2474%; top: 91.4529%; animation-delay: 0.72986s; animation-duration: 3.61856s;"></div><div class="particle star" style="width: 2.47053px; height: 2.47053px; left: 5.98991%; top: 32.4335%; animation-delay: 0.905665s; animation-duration: 5.76784s;"></div><div class="particle star" style="width: 1.73477px; height: 1.73477px; left: 37.1786%; top: 9.62376%; animation-delay: 3.28855s; animation-duration: 5.83887s;"></div><div class="particle star" style="width: 2.04452px; height: 2.04452px; left: 60.7474%; top: 0.548317%; animation-delay: 1.63541s; animation-duration: 4.249s;"></div><div class="particle star" style="width: 1.4547px; height: 1.4547px; left: 43.8375%; top: 46.4758%; animation-delay: 0.653421s; animation-duration: 3.54487s;"></div><div class="particle distant-star" style="width: 1.00572px; height: 1.00572px; left: 39.5385%; top: 6.97684%; animation-delay: 3.02835s; animation-duration: 3.1378s;"></div><div class="particle star" style="width: 2.14697px; height: 2.14697px; left: 36.3386%; top: 52.159%; animation-delay: 2.81588s; animation-duration: 4.34412s;"></div><div class="particle star" style="width: 2.19353px; height: 2.19353px; left: 9.71963%; top: 92.5015%; animation-delay: 3.28628s; animation-duration: 3.22139s;"></div><div class="particle blue-star" style="width: 1.63463px; height: 1.63463px; left: 95.5373%; top: 45.2333%; animation-delay: 1.26328s; animation-duration: 4.841s;"></div><div class="particle star" style="width: 1.73325px; height: 1.73325px; left: 69.023%; top: 86.4896%; animation-delay: 3.3524s; animation-duration: 3.31126s;"></div><div class="particle star" style="width: 2.05404px; height: 2.05404px; left: 61.3204%; top: 66.4754%; animation-delay: 2.15795s; animation-duration: 3.18251s;"></div><div class="particle star" style="width: 1.00854px; height: 1.00854px; left: 8.04256%; top: 33.3774%; animation-delay: 2.86937s; animation-duration: 3.32734s;"></div><div class="particle blue-star" style="width: 1.96652px; height: 1.96652px; left: 86.1778%; top: 12.2479%; animation-delay: 1.46103s; animation-duration: 3.15897s;"></div><div class="particle star" style="width: 2.18265px; height: 2.18265px; left: 18.7719%; top: 39.906%; animation-delay: 3.91175s; animation-duration: 3.4518s;"></div><div class="particle star" style="width: 2.06416px; height: 2.06416px; left: 99.5335%; top: 57.8116%; animation-delay: 1.65048s; animation-duration: 3.35348s;"></div><div class="particle distant-star" style="width: 1.12461px; height: 1.12461px; left: 86.8806%; top: 91.3744%; animation-delay: 0.439921s; animation-duration: 4.62934s;"></div><div class="particle shooting-star" style="width: 2.59503px; height: 0.86501px; left: -100px; top: 220.761px;"></div></div>

    <div class="container fade-in">
        <div class="header">
            <h1 class="logo typewriter-container" id="typewriterLogo"><span class="typewriter-text">Niet elke fout is een tegenslag</span><span class="typewriter-cursor"></span></h1>
            <div class="search-container">
                <div class="search-wrapper">
                    <input type="text" class="search-input" placeholder="Zoekterm invoeren..." id="searchInput">
                    <button class="search-button" id="searchButton">
                        <svg class="search-icon-svg">
                            <use href="#search-icon"></use>
                        </svg>
                        <span class="search-text">Zoeken</span>
                    </button>
                </div>
                <div class="search-selector">
                    <button class="search-select" id="searchEngineBtn">Edge</button>
                    <div class="search-engine-dropdown" id="searchEngineDropdown" style="display: none;">
                        <div class="search-engine-option" data-engine="edge">Edge</div>
                        <div class="search-engine-option" data-engine="google">Google</div>
                        <div class="search-engine-option" data-engine="youtube">YouTube</div>
                        <div class="search-engine-option" data-engine="bilibili">Bilibili</div>
                        <div class="search-engine-option" data-engine="tiktok">TikTok</div>
                        <div class="search-engine-option" data-engine="zhihu">Zhihu</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bookmarks">
            <div id="bookmarkSections"><div class="bookmark-section">
                    <div class="section-header">
                        <h2 class="section-title">Mijn bladwijzers</h2>
                        <div class="section-controls">
                            <button class="add-bookmark" data-section-id="main">
                                <svg class="plus-icon">
                                    <use href="#plus-icon"></use>
                                </svg>
                                <span class="add-text">Toevoegen</span>
                            </button>
                            
                        </div>
                    </div>
                    <div class="bookmark-grid" id="grid-main"><a href="https://www.youtube.com/" target="_blank" class="bookmark-item" data-section-id="main" data-index="0" draggable="false">
                    <div class="bookmark-icon">Y</div>
                    <div class="bookmark-info">
                        <h3 title="YouTube" class="bookmark-title">YouTube</h3>
                        <p title="Videoplatform" class="bookmark-desc">Videoplatform</p>
                    </div>
                    <button class="remove-bookmark" data-section-id="main" data-index="0">
                        <svg class="delete-icon">
                            <use href="#delete-icon"></use>
                        </svg>
                    </button>
                </a><a href="https://translate.google.com/" target="_blank" class="bookmark-item" data-section-id="main" data-index="1" draggable="false">
                    <div class="bookmark-icon">GT</div>
                    <div class="bookmark-info">
                        <h3 title="Google Translate" class="bookmark-title">Google Translate</h3>
                        <p title="Vertaaldienst" class="bookmark-desc">Vertaaldienst</p>
                    </div>
                    <button class="remove-bookmark" data-section-id="main" data-index="1">
                        <svg class="delete-icon">
                            <use href="#delete-icon"></use>
                        </svg>
                    </button>
                </a><a href="https://github.com/" target="_blank" class="bookmark-item" data-section-id="main" data-index="2" draggable="false">
                    <div class="bookmark-icon">G</div>
                    <div class="bookmark-info">
                        <h3 title="GitHub" class="bookmark-title">GitHub</h3>
                        <p title="Code-repository" class="bookmark-desc">Code-repository</p>
                    </div>
                    <button class="remove-bookmark" data-section-id="main" data-index="2">
                        <svg class="delete-icon">
                            <use href="#delete-icon"></use>
                        </svg>
                    </button>
                </a><a href="https://www.bilibili.com/" target="_blank" class="bookmark-item" data-section-id="main" data-index="3" draggable="false">
                    <div class="bookmark-icon">B</div>
                    <div class="bookmark-info">
                        <h3 title="Bilibili" class="bookmark-title">Bilibili</h3>
                        <p title="Videogemeenschap" class="bookmark-desc">Videogemeenschap</p>
                    </div>
                    <button class="remove-bookmark" data-section-id="main" data-index="3">
                        <svg class="delete-icon">
                            <use href="#delete-icon"></use>
                        </svg>
                    </button>
                </a></div>
                </div><div class="bookmark-section">
                    <div class="section-header">
                        <h2 class="section-title">Extra bladwijzers</h2>
                        <div class="section-controls">
                            <button class="add-bookmark" data-section-id="additional">
                                <svg class="plus-icon">
                                    <use href="#plus-icon"></use>
                                </svg>
                                <span class="add-text">Toevoegen</span>
                            </button>
                            
                                <button class="rename-section" data-section-id="additional" title="Klik om te bewerken">
                                    <svg class="edit-icon">
                                        <use href="#edit-icon"></use>
                                    </svg>
                                </button>
                                <button class="delete-section" data-section-id="additional" title="Klik om te verwijderen">
                                    <svg class="delete-icon">
                                        <use href="#delete-icon"></use>
                                    </svg>
                                </button>
                            
                        </div>
                    </div>
                    <div class="bookmark-grid" id="grid-additional"><a href="file:///C:/Users/30341/Desktop/1" target="_blank" class="bookmark-item" data-section-id="additional" data-index="0" draggable="false">
                    <div class="bookmark-icon">1</div>
                    <div class="bookmark-info">
                        <h3 title="1" class="bookmark-title">1</h3>
                        <p title="" class="bookmark-desc"></p>
                    </div>
                    <button class="remove-bookmark" data-section-id="additional" data-index="0">
                        <svg class="delete-icon">
                            <use href="#delete-icon"></use>
                        </svg>
                    </button>
                </a><a href="https://leetcode.cn/" target="_blank" class="bookmark-item" data-section-id="additional" data-index="1" draggable="false">
                    <div class="bookmark-icon">L</div>
                    <div class="bookmark-info">
                        <h3 title="Leetcode" class="bookmark-title">Leetcode</h3>
                        <p title="" class="bookmark-desc"></p>
                    </div>
                    <button class="remove-bookmark" data-section-id="additional" data-index="1">
                        <svg class="delete-icon">
                            <use href="#delete-icon"></use>
                        </svg>
                    </button>
                </a><a href="file:///C:/Users/30341/Desktop/2" target="_blank" class="bookmark-item" data-section-id="additional" data-index="2" draggable="false">
                    <div class="bookmark-icon">2</div>
                    <div class="bookmark-info">
                        <h3 title="2" class="bookmark-title">2</h3>
                        <p title="" class="bookmark-desc"></p>
                    </div>
                    <button class="remove-bookmark" data-section-id="additional" data-index="2">
                        <svg class="delete-icon">
                            <use href="#delete-icon"></use>
                        </svg>
                    </button>
                </a></div>
                </div><div class="bookmark-section">
                    <div class="section-header">
                        <h2 class="section-title">s</h2>
                        <div class="section-controls">
                            <button class="add-bookmark" data-section-id="section_1753518318759">
                                <svg class="plus-icon">
                                    <use href="#plus-icon"></use>
                                </svg>
                                <span class="add-text">Toevoegen</span>
                            </button>
                            
                                <button class="rename-section" data-section-id="section_1753518318759" title="Klik om te bewerken">
                                    <svg class="edit-icon">
                                        <use href="#edit-icon"></use>
                                    </svg>
                                </button>
                                <button class="delete-section" data-section-id="section_1753518318759" title="Klik om te verwijderen">
                                    <svg class="delete-icon">
                                        <use href="#delete-icon"></use>
                                    </svg>
                                </button>
                            
                        </div>
                    </div>
                    <div class="bookmark-grid" id="grid-section_1753518318759"><a href="file:///C:/Users/30341/Desktop/1" target="_blank" class="bookmark-item" data-section-id="section_1753518318759" data-index="0" draggable="false">
                    <div class="bookmark-icon">1</div>
                    <div class="bookmark-info">
                        <h3 title="1" class="bookmark-title">1</h3>
                        <p title="1" class="bookmark-desc">1</p>
                    </div>
                    <button class="remove-bookmark" data-section-id="section_1753518318759" data-index="0">
                        <svg class="delete-icon">
                            <use href="#delete-icon"></use>
                        </svg>
                    </button>
                </a></div>
                </div><div class="bookmark-section">
                    <div class="section-header">
                        <h2 class="section-title">2</h2>
                        <div class="section-controls">
                            <button class="add-bookmark" data-section-id="section_1753784927213">
                                <svg class="plus-icon">
                                    <use href="#plus-icon"></use>
                                </svg>
                                <span class="add-text">Toevoegen</span>
                            </button>
                            
                                <button class="rename-section" data-section-id="section_1753784927213" title="Klik om te bewerken">
                                    <svg class="edit-icon">
                                        <use href="#edit-icon"></use>
                                    </svg>
                                </button>
                                <button class="delete-section" data-section-id="section_1753784927213" title="Klik om te verwijderen">
                                    <svg class="delete-icon">
                                        <use href="#delete-icon"></use>
                                    </svg>
                                </button>
                            
                        </div>
                    </div>
                    <div class="bookmark-grid" id="grid-section_1753784927213"></div>
                </div></div>
            <button class="add-section" id="addSectionBtn">+ Nieuwe sectie toevoegen</button>
        </div>
    </div>

    <!-- Add Bookmark Modal -->
    <div class="modal" id="addBookmarkModal" style="display: none;">
        <div class="modal-content" style="position: relative;">
            <h3>Nieuw bladwijzer toevoegen</h3>
            <input type="text" id="bookmarkName" placeholder="Website naam">
            <input type="url" id="bookmarkUrl" placeholder="https://example.com">
            <input type="text" id="bookmarkDesc" placeholder="Korte beschrijving">
            <div class="modal-buttons">
                <button class="cancel" onclick="closeBookmarkModal()">Annuleren</button>
                <button onclick="addBookmark()">Toevoegen</button>
            </div>
        <div style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); width: 16px; height: 16px; border-width: 2px; border-style: solid; border-color: rgba(255, 255, 255, 0.8) rgba(255, 255, 255, 0.3) rgba(255, 255, 255, 0.3); border-image: initial; border-radius: 50%; animation: 1s linear 0s infinite normal none running spin; display: none; pointer-events: none;"></div></div>
    </div>

    <!-- Add Section Modal -->
    <div class="modal" id="addSectionModal" style="display: none;">
        <div class="modal-content">
            <h3>Nieuwe sectie maken</h3>
            <input type="text" id="sectionName" placeholder="Sectienaam">
            <div class="modal-buttons">
                <button class="cancel" onclick="closeSectionModal()">Annuleren</button>
                <button onclick="addSection()">Maken</button>
            </div>
        </div>
    </div>

    <!-- Rename Section Modal -->
    <div class="modal" id="renameSectionModal" style="display: none;">
        <div class="modal-content">
            <h3>Sectie hernoemen</h3>
            <input type="text" id="newSectionName" placeholder="Nieuwe naam">
            <div class="modal-buttons">
                <button class="cancel" onclick="closeRenameModal()">Annuleren</button>
                <button onclick="confirmRename()">Hernoemen</button>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div class="modal" id="alertModal" style="display: none;">
        <div class="modal-content">
            <h3 id="alertTitle" style="margin-bottom: 0.8rem;">名前を入力してください！</h3>
            <p id="alertMessage" style="margin-top: 0; margin-bottom: 1.5rem;">名前を入力してください！</p>
            <div class="modal-buttons">
                <button onclick="closeAlertModal()">OK</button>
            </div>
        </div>
    </div>

    <!-- Confirm Modal -->
    <div class="modal" id="confirmModal" style="display: none;">
        <div class="modal-content">
            <h3 id="confirmTitle" style="margin-bottom: 0.8rem;">确定删除分区吗？所有书签都将丢失！?</h3>
            <p id="confirmMessage" style="margin-top: 0; margin-bottom: 1.5rem;">确定删除分区吗？所有书签都将丢失！</p>
            <div class="modal-buttons">
                <button class="cancel" onclick="closeConfirmModal()">Annuleren</button>
                <button id="confirmButton">OK</button>
            </div>
        </div>
    </div>

    <script>
        // Optimized Drag and Drop System
        let dragState = {
            isDragging: false,
            draggedElement: null,
            draggedIndex: null,
            draggedSectionId: null,
            startPos: { x: 0, y: 0 },
            longPressTimer: null,
            isLongPress: false,
            lastTargetElement: null
        };

        function setupDragAndDrop(sectionId) {
            const bookmarkItems = document.querySelectorAll(`#grid-${sectionId} .bookmark-item`);
            
            bookmarkItems.forEach((item, index) => {
                // Remove existing event listeners to prevent duplicates
                item.removeEventListener('mousedown', handleMouseDown);
                item.removeEventListener('touchstart', handleTouchStart);
                
                // Add new event listeners
                item.addEventListener('mousedown', handleMouseDown);
                item.addEventListener('touchstart', handleTouchStart, { passive: false });
                
                // Prevent default link behavior during drag operations
                item.addEventListener('click', (e) => {
                    if (dragState.isLongPress || dragState.isDragging) {
                        e.preventDefault();
                        dragState.isLongPress = false;
                    }
                });
            });
        }

        function handleMouseDown(e) {
            if (e.button !== 0) return; // Only left mouse button
            
            const startX = e.clientX;
            const startY = e.clientY;
            const item = e.currentTarget;
            
            dragState.longPressTimer = setTimeout(() => {
                startDragging(item, startX, startY);
            }, 500); // 500ms long press
            
            const mouseUpHandler = () => {
                clearTimeout(dragState.longPressTimer);
                document.removeEventListener('mouseup', mouseUpHandler);
                document.removeEventListener('mousemove', mouseMoveHandler);
            };
            
            const mouseMoveHandler = (e) => {
                const distance = Math.sqrt(
                    Math.pow(e.clientX - startX, 2) + Math.pow(e.clientY - startY, 2)
                );
                if (distance > 10) {
                    clearTimeout(dragState.longPressTimer);
                }
            };
            
            document.addEventListener('mouseup', mouseUpHandler);
            document.addEventListener('mousemove', mouseMoveHandler);
        }

        function handleTouchStart(e) {
            e.preventDefault(); // Prevent scrolling during touch
            e.stopPropagation(); // 防止事件冒泡
            
            const touch = e.touches[0];
            const startX = touch.clientX;
            const startY = touch.clientY;
            const item = e.currentTarget;
            
            // Enhanced touch tracking
            let isTap = true;
            let hasMoved = false;
            let startTime = Date.now();
            
            // Prevent accidental navigation during scroll/swipe
            const maxTapDistance = 10; // pixels
            const maxTapDuration = 300; // milliseconds
            
            dragState.longPressTimer = setTimeout(() => {
                startDragging(item, startX, startY);
                isTap = false;
                // Add haptic feedback if available
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
            }, 600); // 600ms long press for touch
            
            const touchEndHandler = (e) => {
                clearTimeout(dragState.longPressTimer);
                document.removeEventListener('touchend', touchEndHandler);
                document.removeEventListener('touchmove', touchMoveHandler);
                
                const endTime = Date.now();
                const duration = endTime - startTime;
                
                // Enhanced tap detection
                if (isTap && !dragState.isDragging && !hasMoved && duration < maxTapDuration) {
                    // This was a deliberate tap
                    const url = item.getAttribute('href');
                    if (url) {
                        e.preventDefault();
                        window.open(url, '_blank');
                    }
                }
            };
            
            const touchMoveHandler = (e) => {
                const touch = e.touches[0];
                const distance = Math.sqrt(
                    Math.pow(touch.clientX - startX, 2) + Math.pow(touch.clientY - startY, 2)
                );
                
                if (distance > maxTapDistance) {
                    hasMoved = true;
                    clearTimeout(dragState.longPressTimer);
                    isTap = false;
                }
            };
            
            document.addEventListener('touchend', touchEndHandler);
            document.addEventListener('touchmove', touchMoveHandler, { passive: false });
        }

        function startDragging(element, startX, startY) {
            dragState.isDragging = true;
            dragState.isLongPress = true;
            dragState.draggedElement = element;
            dragState.draggedIndex = parseInt(element.dataset.index);
            dragState.draggedSectionId = element.dataset.sectionId;
    
            // Create visual clone
            const clone = element.cloneNode(true);
            clone.style.position = 'fixed';
            clone.style.width = element.offsetWidth + 'px';
            clone.style.zIndex = '1001';
            clone.style.opacity = '0.9';
            clone.style.pointerEvents = 'none';
            clone.style.transform = 'rotate(2deg) scale(1.02)';
            clone.style.boxShadow = '0 20px 40px rgba(0, 0, 0, 0.6)';
            clone.id = 'dragClone';
            document.body.appendChild(clone);
    
            // Mark original element as dragging
            element.classList.add('dragging');
    
            const rect = element.getBoundingClientRect();
            const offsetX = startX - rect.left;
            const offsetY = startY - rect.top;
    
            function moveClone(e) {
                if (!dragState.isDragging) return;
                e.preventDefault();
    
                const x = (e.type === 'mousemove' ? e.clientX : e.touches[0].clientX) - offsetX;
                const y = (e.type === 'mousemove' ? e.clientY : e.touches[0].clientY) - offsetY;
                clone.style.left = x + 'px';
                clone.style.top = y + 'px';
    
                const mouseY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
                const mouseX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
                updateDragTarget(mouseX, mouseY);
            }
    
            function endDrag(e) {
                if (!dragState.isDragging) return;
    
                const cloneElement = document.getElementById('dragClone');
                if (cloneElement) {
                    document.body.removeChild(cloneElement);
                }
                
                element.classList.remove('dragging');
                clearDragTargets();
    
                document.removeEventListener('mousemove', moveClone);
                document.removeEventListener('touchmove', moveClone);
                document.removeEventListener('mouseup', endDrag);
                document.removeEventListener('touchend', endDrag);
    
                // Finalize the drag operation
                if (dragState.lastTargetElement && dragState.lastTargetElement !== element) {
                    const targetIndex = parseInt(dragState.lastTargetElement.dataset.index);
                    performSwap(dragState.draggedIndex, targetIndex);
                }
    
                resetDragState();
            }
    
            // Position the clone initially
            clone.style.left = rect.left + 'px';
            clone.style.top = rect.top + 'px';
    
            document.addEventListener('mousemove', moveClone);
            document.addEventListener('touchmove', moveClone, { passive: false });
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
        }

        function updateDragTarget(mouseX, mouseY) {
            const grid = document.getElementById(`grid-${dragState.draggedSectionId}`);
            const items = Array.from(grid.querySelectorAll('.bookmark-item:not(.dragging)'));
    
            // Clear previous target
            if (dragState.lastTargetElement) {
                dragState.lastTargetElement.classList.remove('drag-target');
            }
    
            // Find the closest item
            let closestItem = null;
            let minDistance = Infinity;
    
            items.forEach(item => {
                const rect = item.getBoundingClientRect();
                const itemCenterX = rect.left + rect.width / 2;
                const itemCenterY = rect.top + rect.height / 2;
                
                // Calculate distance from mouse to item center
                const distance = Math.sqrt(
                    Math.pow(mouseX - itemCenterX, 2) + 
                    Math.pow(mouseY - itemCenterY, 2)
                );
                
                // Check if mouse is within the item bounds
                if (mouseX >= rect.left && mouseX <= rect.right && 
                    mouseY >= rect.top && mouseY <= rect.bottom) {
                    if (distance < minDistance) {
                        minDistance = distance;
                        closestItem = item;
                    }
                }
            });
    
            // Set new target
            if (closestItem) {
                closestItem.classList.add('drag-target');
                dragState.lastTargetElement = closestItem;
            } else {
                dragState.lastTargetElement = null;
            }
        }

        function performSwap(fromIndex, toIndex) {
            if (fromIndex === toIndex) return;
            
            const section = bookmarkSections.find(s => s.id === dragState.draggedSectionId);
            if (!section) return;
    
            // Perform the swap in the data array
            const [movedBookmark] = section.bookmarks.splice(fromIndex, 1);
            section.bookmarks.splice(toIndex, 0, movedBookmark);
            
            // Save and re-render
            saveSections();
            renderBookmarks(dragState.draggedSectionId);
        }

        function clearDragTargets() {
            const items = document.querySelectorAll('.bookmark-item.drag-target');
            items.forEach(item => item.classList.remove('drag-target'));
        }

        function resetDragState() {
            dragState.isDragging = false;
            dragState.draggedElement = null;
            dragState.draggedIndex = null;
            dragState.draggedSectionId = null;
            dragState.isLongPress = false;
            dragState.lastTargetElement = null;
        }

        // Sternenhimmel-Partikel-System
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            
            particlesContainer.innerHTML = '';

            // Statische Sterne erstellen
            function createStars() {
                const starCount = 100;
                
                for (let i = 0; i < starCount; i++) {
                    const star = document.createElement('div');
                    const starType = Math.random();
                    
                    if (starType < 0.7) {
                        star.className = 'particle star';
                        star.style.width = (Math.random() * 2 + 1) + 'px';
                        star.style.height = star.style.width;
                    } else if (starType < 0.9) {
                        star.className = 'particle blue-star';
                        star.style.width = (Math.random() * 1.5 + 0.8) + 'px';
                        star.style.height = star.style.width;
                    } else {
                        star.className = 'particle distant-star';
                        star.style.width = (Math.random() * 1 + 0.5) + 'px';
                        star.style.height = star.style.width;
                    }
                    
                    star.style.left = Math.random() * 100 + '%';
                    star.style.top = Math.random() * 100 + '%';
                    star.style.animationDelay = Math.random() * 4 + 's';
                    star.style.animationDuration = (Math.random() * 3 + 3) + 's';
                    
                    particlesContainer.appendChild(star);
                }
            }
            
            // Sternschnuppen erstellen
            function createShootingStar() {
                const shootingStar = document.createElement('div');
                shootingStar.className = 'particle shooting-star';
                
                const size = Math.random() * 3 + 2;
                shootingStar.style.width = size + 'px';
                shootingStar.style.height = (size / 3) + 'px';
                
                const startY = Math.random() * window.innerHeight * 0.6;
                shootingStar.style.left = '-100px';
                shootingStar.style.top = startY + 'px';
                
                particlesContainer.appendChild(shootingStar);
                
                setTimeout(() => {
                    if (shootingStar.parentNode) {
                        shootingStar.parentNode.removeChild(shootingStar);
                    }
                }, 3000);
            }
            
            // Initialisierung
            createStars();
            
            // Sternschnuppen in zufälligen Intervallen
            function randomShootingStar() {
                createShootingStar();
                setTimeout(randomShootingStar, Math.random() * 8000 + 5000);
            }
            
            setTimeout(randomShootingStar, Math.random() * 3000 + 2000);
        }

        // Suche
        const searchInput = document.getElementById('searchInput');
        const searchButton = document.getElementById('searchButton');
        const searchEngineBtn = document.getElementById('searchEngineBtn');
        
        // Search engine persistence
        let currentSearchEngine = localStorage.getItem('zane-search-engine') || 'edge';
        
        function loadSearchEngine() {
            const engineName = getEngineDisplayName(currentSearchEngine);
            searchEngineBtn.textContent = engineName;
        }
        
        function updateSearchEngineDisplay() {
            // Update display based on current language
            const displayName = getEngineDisplayName(currentSearchEngine);
            searchEngineBtn.textContent = displayName;
            
            // Update dropdown options
            document.querySelectorAll('.search-engine-option').forEach(option => {
                const engine = option.getAttribute('data-engine');
                if (engine === 'tiktok') {
                    option.textContent = currentLanguage === 'zh' ? '抖音' : 'TikTok';
                } else if (engine === 'zhihu') {
                    option.textContent = currentLanguage === 'zh' ? '知乎' : 'Zhihu';
                }
            });
        }
        
        function getEngineDisplayName(engine) {
            const names = {
                edge: 'Edge',
                google: 'Google',
                youtube: 'YouTube',
                bilibili: 'Bilibili',
                tiktok: currentLanguage === 'zh' ? '抖音' : 'TikTok',
                zhihu: '知乎',
                douyin: '抖音'
            };
            return names[engine] || 'Edge';
        }
        
        function saveSearchEngine(engine) {
            currentSearchEngine = engine;
            localStorage.setItem('zane-search-engine', engine);
        }

        const searchUrls = {
            bilibili: 'https://search.bilibili.com/all?keyword=',
            google: 'https://www.google.com/search?q=',
            youtube: 'https://www.youtube.com/results?search_query=',
            zhihu: 'https://www.zhihu.com/search?type=content&q=',
            edge: 'https://www.bing.com/search?q=',
            tiktok: 'https://www.tiktok.com/search?q=',
            douyin: 'https://www.douyin.com/search/'
        };

        function performSearch() {
            const query = searchInput.value.trim();
            
            if (query) {
                const encodedQuery = encodeURIComponent(query);
                let engine = currentSearchEngine;
                
                // Use Douyin for Chinese language when TikTok is selected
                if (currentLanguage === 'zh' && engine === 'tiktok') {
                    engine = 'douyin';
                }
                
                const searchUrl = searchUrls[engine] + encodedQuery;
                window.open(searchUrl, '_blank');
            }
        }

        searchButton.addEventListener('click', performSearch);
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                performSearch();
            }
        });

        // Lesezeichen- und Bereich-Management
        let bookmarkSections = [];
        let currentSectionId = null;
        let currentRenameId = null;

        function loadSections() {
            const stored = localStorage.getItem('zanes-sections');
            const langData = translations[currentLanguage] || translations.de;
            
            if (!stored) {
                // Default sections for first-time visitors
                bookmarkSections = [
                    {
                        id: 'main',
                        name: langData.defaultSection,
                        bookmarks: [
                            { name: 'GitHub', url: 'https://github.com/', desc: langData.githubDesc },
                            { name: 'Google Translate', url: 'https://translate.google.com/', desc: langData.googleTranslateDesc },
                            { name: 'Bilibili', url: 'https://www.bilibili.com/', desc: langData.bilibiliDesc },
                            { name: 'YouTube', url: 'https://www.youtube.com/', desc: langData.youtubeDesc }
                        ],
                        isDefault: true
                    },
                    {
                        id: 'additional',
                        name: langData.additionalSection,
                        bookmarks: [],
                        isDefault: false
                    }
                ];
                saveSections();
            } else {
                try {
                    bookmarkSections = JSON.parse(stored);
                    
                    // Ensure main section exists with proper structure and default bookmarks
                    let mainSection = bookmarkSections.find(s => s.id === 'main');
                    if (!mainSection) {
                        mainSection = {
                            id: 'main',
                            name: langData.defaultSection,
                            bookmarks: [
                                { name: 'GitHub', url: 'https://github.com/', desc: langData.githubDesc },
                                { name: 'Google Translate', url: 'https://translate.google.com/', desc: langData.googleTranslateDesc },
                                { name: 'Bilibili', url: 'https://www.bilibili.com/', desc: langData.bilibiliDesc },
                                { name: 'YouTube', url: 'https://www.youtube.com/', desc: langData.youtubeDesc }
                            ],
                            isDefault: true
                        };
                        bookmarkSections.unshift(mainSection);
                        saveSections();
                    } else if (mainSection.bookmarks.length === 0) {
                        // Restore default bookmarks if main section exists but is empty
                        mainSection.bookmarks = [
                            { name: 'GitHub', url: 'https://github.com/', desc: langData.githubDesc },
                            { name: 'Google Translate', url: 'https://translate.google.com/', desc: langData.googleTranslateDesc },
                            { name: 'Bilibili', url: 'https://www.bilibili.com/', desc: langData.bilibiliDesc },
                            { name: 'YouTube', url: 'https://www.youtube.com/', desc: langData.youtubeDesc }
                        ];
                        saveSections();
                    }
                    
                    // Ensure additional section exists
                    let additionalSection = bookmarkSections.find(s => s.id === 'additional');
                    if (!additionalSection) {
                        additionalSection = {
                            id: 'additional',
                            name: langData.additionalSection,
                            bookmarks: [],
                            isDefault: false
                        };
                        bookmarkSections.push(additionalSection);
                        saveSections();
                    }
                    
                } catch (e) {
                    console.error('Error parsing stored sections:', e);
                    // Fallback to default sections if parsing fails
                    bookmarkSections = [
                        {
                            id: 'main',
                            name: langData.defaultSection,
                            bookmarks: [
                                { name: 'GitHub', url: 'https://github.com/', desc: langData.githubDesc },
                                { name: 'Google Translate', url: 'https://translate.google.com/', desc: langData.googleTranslateDesc },
                                { name: 'Bilibili', url: 'https://www.bilibili.com/', desc: langData.bilibiliDesc },
                                { name: 'YouTube', url: 'https://www.youtube.com/', desc: langData.youtubeDesc }
                            ],
                            isDefault: true
                        },
                        {
                            id: 'additional',
                            name: langData.additionalSection,
                            bookmarks: [],
                            isDefault: false
                        }
                    ];
                    saveSections();
                }
            }
            renderSections();
        }

        function saveSections() {
            localStorage.setItem('zanes-sections', JSON.stringify(bookmarkSections));
        }

        function renderSections() {
            const container = document.getElementById('bookmarkSections');
            container.innerHTML = '';
            
            bookmarkSections.forEach(section => {
                const sectionElement = document.createElement('div');
                sectionElement.className = 'bookmark-section';
                const langData = translations[currentLanguage] || translations.de;
                sectionElement.innerHTML = `
                    <div class="section-header">
                        <h2 class="section-title">${section.name}</h2>
                        <div class="section-controls">
                            <button class="add-bookmark" data-section-id="${section.id}">
                                <svg class="plus-icon">
                                    <use href="#plus-icon"/>
                                </svg>
                                <span class="add-text">${langData.addBookmarkBtn}</span>
                            </button>
                            ${!section.isDefault ? `
                                <button class="rename-section" data-section-id="${section.id}" title="${langData.editPrompt}">
                                    <svg class="edit-icon">
                                        <use href="#edit-icon"/>
                                    </svg>
                                </button>
                                <button class="delete-section" data-section-id="${section.id}" title="${langData.deletePrompt}">
                                    <svg class="delete-icon">
                                        <use href="#delete-icon"/>
                                    </svg>
                                </button>
                            ` : ''}
                        </div>
                    </div>
                    <div class="bookmark-grid" id="grid-${section.id}"></div>
                `;
                container.appendChild(sectionElement);
                renderBookmarks(section.id);
            });
            
            setupSectionEventListeners();
        }

        function setupSectionEventListeners() {
            document.querySelectorAll('.add-bookmark').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    const sectionId = button.getAttribute('data-section-id');
                    openBookmarkModal(sectionId);
                });
            });
            
            document.querySelectorAll('.rename-section').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    const sectionId = button.getAttribute('data-section-id');
                    openRenameModal(sectionId);
                });
            });
            
            document.querySelectorAll('.delete-section').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    const sectionId = button.getAttribute('data-section-id');
                    deleteSection(sectionId);
                });
            });
        }

        function renderBookmarks(sectionId) {
            const section = bookmarkSections.find(s => s.id === sectionId);
            if (!section) return;
            
            const grid = document.getElementById(`grid-${sectionId}`);
            if (!grid) return;
            
            grid.innerHTML = '';
            
            section.bookmarks.forEach((bookmark, index) => {
                const bookmarkItem = document.createElement('a');
                bookmarkItem.href = bookmark.url;
                bookmarkItem.target = '_blank';
                bookmarkItem.className = 'bookmark-item';
                bookmarkItem.dataset.sectionId = sectionId;
                bookmarkItem.dataset.index = index;
                bookmarkItem.draggable = false;
                
                const initials = getInitials(bookmark.name);
                
                bookmarkItem.innerHTML = `
                    <div class="bookmark-icon">${initials}</div>
                    <div class="bookmark-info">
                        <h3 title="${bookmark.name}" class="bookmark-title">${bookmark.name}</h3>
                        <p title="${bookmark.desc || ''}" class="bookmark-desc">${bookmark.desc || ''}</p>
                    </div>
                    <button class="remove-bookmark" data-section-id="${sectionId}" data-index="${index}">
                        <svg class="delete-icon">
                            <use href="#delete-icon"></use>
                        </svg>
                    </button>
                `;
                
                grid.appendChild(bookmarkItem);
            });
            
            setupDragAndDrop(sectionId);
            setupRemoveButtons(sectionId);
        }

        function setupRemoveButtons(sectionId) {
            const grid = document.getElementById(`grid-${sectionId}`);
            if (!grid) return;
            
            grid.querySelectorAll('.remove-bookmark').forEach(button => {
                // Remove existing listeners to prevent duplicates
                button.removeEventListener('click', handleRemoveClick);
                button.removeEventListener('touchend', handleRemoveTouch);
                
                // Add new listeners
                button.addEventListener('click', handleRemoveClick);
                button.addEventListener('touchend', handleRemoveTouch);
                
                function handleRemoveClick(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    handleRemove(e);
                }
                
                function handleRemoveTouch(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    handleRemove(e);
                }
                
                function handleRemove(e) {
                    const sectionId = e.currentTarget.getAttribute('data-section-id');
                    const index = parseInt(e.currentTarget.getAttribute('data-index'));
                    
                    const langData = translations[currentLanguage] || translations.de;
                    showConfirm(
                        langData.deleteBookmarkConfirm.split('?')[0] + '?',
                        langData.deleteBookmarkConfirm,
                        () => {
                            const section = bookmarkSections.find(s => s.id === sectionId);
                            if (section) {
                                section.bookmarks.splice(index, 1);
                                saveSections();
                                renderBookmarks(sectionId);
                            }
                        }
                    );
                }
            });
        }

        function getInitials(name) {
            if (!name) return '?';
            return name.split(' ').map(word => word[0]).join('').substring(0, 2).toUpperCase();
        }

        function addSection() {
            const name = document.getElementById('sectionName').value.trim();
            const langData = translations[currentLanguage] || translations.de;
            if (!name) {
                showAlert(langData.sectionNameRequired || 'Please enter a name!', langData.sectionNameRequired || 'Please enter a name!');
                return;
            }
            
            const newSection = {
                id: 'section_' + Date.now().toString(),
                name: name,
                bookmarks: [],
                isDefault: false
            };
            
            bookmarkSections.push(newSection);
            saveSections();
            renderSections();
            closeSectionModal();
        }

        function deleteSection(sectionId) {
            const langData = translations[currentLanguage] || translations.de;
            showConfirm(
                langData.deleteConfirm.split('?')[0] + '?',
                langData.deleteConfirm,
                () => {
                    bookmarkSections = bookmarkSections.filter(s => s.id !== sectionId);
                    saveSections();
                    renderSections();
                }
            );
        }

        function openRenameModal(sectionId) {
            currentRenameId = sectionId;
            const section = bookmarkSections.find(s => s.id === sectionId);
            const modal = document.getElementById('renameSectionModal');
            document.getElementById('newSectionName').value = section.name;
            modal.style.display = 'flex';
            // Force reflow to ensure transition starts from initial state
            modal.offsetHeight;
            modal.classList.add('show');
            document.body.classList.add('modal-open');
            document.getElementById('newSectionName').focus();
        }

        function confirmRename() {
            const newName = document.getElementById('newSectionName').value.trim();
            const langData = translations[currentLanguage] || translations.de;
            if (!newName) {
                showAlert(langData.sectionNameRequired || 'Please enter a name!', langData.sectionNameRequired || 'Please enter a name!');
                return;
            }
            
            const section = bookmarkSections.find(s => s.id === currentRenameId);
            if (section) {
                section.name = newName;
                saveSections();
                renderSections();
            }
            closeRenameModal();
        }

        function addBookmark() {
            const name = document.getElementById('bookmarkName').value.trim();
            const url = document.getElementById('bookmarkUrl').value.trim();
            const desc = document.getElementById('bookmarkDesc').value.trim();
            const langData = translations[currentLanguage] || translations.de;
            
            if (!name || !url) {
                showAlert(langData.bookmarkRequired || 'Please enter name and URL!', langData.bookmarkRequired || 'Please enter name and URL!');
                return;
            }
            
            const section = bookmarkSections.find(s => s.id === currentSectionId);
            if (section) {
                section.bookmarks.push({ name, url, desc });
                saveSections();
                renderBookmarks(currentSectionId);
            }
            closeBookmarkModal();
        }

        function removeBookmark(sectionId, index) {
            const langData = translations[currentLanguage] || translations.de;
            showConfirm(
                langData.deleteBookmarkConfirm.split('?')[0] + '?',
                langData.deleteBookmarkConfirm,
                () => {
                    const section = bookmarkSections.find(s => s.id === sectionId);
                    if (section) {
                        section.bookmarks.splice(index, 1);
                        saveSections();
                        renderBookmarks(sectionId);
                    }
                }
            );
        }

        // Modal functions
        function openBookmarkModal(sectionId) {
            currentSectionId = sectionId;
            const modal = document.getElementById('addBookmarkModal');
            modal.style.display = 'flex';
            // Force reflow to ensure transition starts from initial state
            modal.offsetHeight;
            modal.classList.add('show');
            document.body.classList.add('modal-open');
            document.getElementById('bookmarkName').focus();
        }

        // Enhanced website title recognition with debugging
        async function fetchPageTitle(url) {
            if (!url || !url.trim()) {
                console.log('❌ Empty URL provided');
                return null;
            }
            
            let cleanUrl = url.trim();
            if (!cleanUrl.match(/^https?:\/\//i)) {
                cleanUrl = 'https://' + cleanUrl;
            }
            
            console.log('🔍 Fetching title for:', cleanUrl);
            
            const controller = new AbortController();
            const timeoutId = setTimeout(() => {
                console.log('⏰ Timeout after 3 seconds');
                controller.abort();
            }, 3000);
            
            try {
                const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(cleanUrl)}`;
                console.log('🌐 Using proxy:', proxyUrl);
                
                const response = await fetch(proxyUrl, {
                    signal: controller.signal,
                    headers: {
                        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
                    }
                });
                
                console.log('📡 Response status:', response.status);
                
                if (response.ok) {
                    const data = await response.json();
                    const html = data.contents;
                    
                    console.log('📄 HTML length:', html.length);
                    
                    // Enhanced debugging extraction
                    let title = null;
                    let source = 'unknown';
                    
                    // Title tag
                    const titleMatch = html.match(/<title[^>]*>([^<]+)<\/title>/i);
                    if (titleMatch) {
                        title = titleMatch[1].trim();
                        source = '<title>';
                        console.log('✅ Found title in <title>:', title);
                    }
                    
                    // Open Graph
                    if (!title) {
                        const ogMatch = html.match(/<meta[^>]*property=["']og:title["'][^>]*content=["']([^"']*)["']/i);
                        if (ogMatch) {
                            title = ogMatch[1].trim();
                            source = 'og:title';
                            console.log('✅ Found title in og:title:', title);
                        }
                    }
                    
                    // Meta title
                    if (!title) {
                        const metaMatch = html.match(/<meta[^>]*name=["']title["'][^>]*content=["']([^"']*)["']/i);
                        if (metaMatch) {
                            title = metaMatch[1].trim();
                            source = 'meta title';
                            console.log('✅ Found title in meta title:', title);
                        }
                    }
                    
                    // H1 fallback
                    if (!title) {
                        const h1Match = html.match(/<h1[^>]*>([^<]+)<\/h1>/i);
                        if (h1Match) {
                            title = h1Match[1].trim();
                            source = '<h1>';
                            console.log('✅ Found title in <h1>:', title);
                        }
                    }
                    
                    if (title && title.trim()) {
                        const cleaned = cleanTitle(title.trim());
                        console.log('🎯 Final title from', source + ':', cleaned);
                        return cleaned;
                    } else {
                        console.log('⚠️ No title found in HTML');
                    }
                } else {
                    console.log('❌ HTTP error:', response.status, response.statusText);
                }
                
            } catch (error) {
                console.error('❌ Fetch error:', error.message);
                console.error('Error type:', error.name);
            } finally {
                clearTimeout(timeoutId);
            }
            
            console.log('🔄 Using fallback title');
            const fallback = generateFallbackTitle(cleanUrl);
            console.log('📋 Fallback title:', fallback);
            return fallback;
        }

        // Fast URL-based fallback
        function generateFallbackTitle(url) {
            try {
                const urlObj = new URL(url);
                let domain = urlObj.hostname;
                
                // Remove www and common prefixes
                domain = domain.replace(/^www\./, '');
                
                // Get main domain
                const parts = domain.split('.');
                if (parts.length >= 2) {
                    domain = parts[parts.length - 2];
                }
                
                // Capitalize and clean
                return domain.charAt(0).toUpperCase() + domain.slice(1);
                
            } catch (error) {
                return 'Website';
            }
        }

        // Fast title cleaning
        function cleanTitle(title) {
            if (!title) return 'Website';
            
            let cleaned = title.trim();
            
            // Basic entity decoding
            cleaned = cleaned.replace(/&/g, '&')
                           .replace(/</g, '<')
                           .replace(/>/g, '>')
                           .replace(/"/g, '"')
                           .replace(/'/g, "'");
            
            // Clean whitespace
            cleaned = cleaned.replace(/\s+/g, ' ').trim();
            
            // Remove common suffixes
            const suffixes = [' - Home', ' | Home', ' - Official', ' - Website'];
            for (const suffix of suffixes) {
                if (cleaned.endsWith(suffix)) {
                    cleaned = cleaned.slice(0, -suffix.length).trim();
                }
            }
            
            // Limit length
            if (cleaned.length > 60) {
                cleaned = cleaned.substring(0, 57) + '...';
            }
            
            return cleaned || 'Website';
        }

        // Enhanced title fetching with instant recognition and edge case handling
        function setupTitleFetching() {
            const urlInput = document.getElementById('bookmarkUrl');
            const nameInput = document.getElementById('bookmarkName');
            let fetchTimeout;
            let lastFetchedUrl = '';
            let isFetching = false;

            // Create loading indicator
            const loadingIndicator = document.createElement('div');
            loadingIndicator.style.cssText = `
                position: absolute;
                right: 10px;
                top: 50%;
                transform: translateY(-50%);
                width: 16px;
                height: 16px;
                border: 2px solid rgba(255, 255, 255, 0.3);
                border-top: 2px solid rgba(255, 255, 255, 0.8);
                border-radius: 50%;
                animation: spin 1s linear infinite;
                display: none;
                pointer-events: none;
            `;
            urlInput.parentElement.style.position = 'relative';
            urlInput.parentElement.appendChild(loadingIndicator);

            // Add CSS for spinner animation
            const style = document.createElement('style');
            style.textContent = `
                @keyframes spin {
                    0% { transform: translateY(-50%) rotate(0deg); }
                    100% { transform: translateY(-50%) rotate(360deg); }
                }
            `;
            document.head.appendChild(style);

            // URL normalization helper
            function normalizeUrl(url) {
                if (!url) return '';
                let cleanUrl = url.trim();
                if (!cleanUrl.match(/^https?:\/\//i)) {
                    cleanUrl = 'https://' + cleanUrl;
                }
                return cleanUrl;
            }

            // Instant recognition with aggressive caching
            const instantFetch = debounce(async (url) => {
                if (!url || isFetching) return;
                
                const normalizedUrl = normalizeUrl(url);
                if (!normalizedUrl || !normalizedUrl.startsWith('http')) return;
                
                // Prevent duplicate fetches
                if (normalizedUrl === lastFetchedUrl && nameInput.value && nameInput.value !== normalizedUrl) return;
                
                isFetching = true;
                loadingIndicator.style.display = 'block';
                
                try {
                    // Try cache first
                    const cached = sessionStorage.getItem(`title_${normalizedUrl}`);
                    if (cached) {
                        const title = JSON.parse(cached);
                        if (title && (!nameInput.value || nameInput.value === normalizedUrl)) {
                            nameInput.value = title;
                            nameInput.select();
                            lastFetchedUrl = normalizedUrl;
                            return;
                        }
                    }
                    
                    // Fetch with enhanced recognition
                    const title = await fetchPageTitle(normalizedUrl);
                    if (title && (!nameInput.value || nameInput.value === normalizedUrl || nameInput.value === lastFetchedUrl)) {
                        nameInput.value = title;
                        nameInput.select();
                        lastFetchedUrl = normalizedUrl;
                        
                        // Cache for instant future use
                        sessionStorage.setItem(`title_${normalizedUrl}`, JSON.stringify(title));
                    }
                } catch (error) {
                    console.warn('Title fetch failed:', error);
                    // Use fallback without showing error to user
                    const fallback = generateFallbackTitle(normalizedUrl);
                    if (!nameInput.value) {
                        nameInput.value = fallback;
                    }
                } finally {
                    isFetching = false;
                    loadingIndicator.style.display = 'none';
                }
            }, 200); // Ultra-fast 200ms debounce for instant recognition

            // Enhanced input handling for all platforms
            urlInput.addEventListener('input', (e) => {
                const url = e.target.value.trim();
                if (url) {
                    instantFetch(url);
                } else {
                    loadingIndicator.style.display = 'none';
                }
            });

            // Handle paste events with immediate processing
            urlInput.addEventListener('paste', (e) => {
                setTimeout(() => {
                    const url = e.target.value.trim();
                    if (url) {
                        instantFetch(url);
                    }
                }, 50); // Increased timeout for paste processing
            });

            // Handle blur with instant fetch
            urlInput.addEventListener('blur', () => {
                const url = urlInput.value.trim();
                if (url && (!nameInput.value || nameInput.value === url)) {
                    instantFetch(url);
                }
            });

            // Handle Enter key for immediate fetch
            urlInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const url = urlInput.value.trim();
                    if (url) {
                        instantFetch(url);
                    }
                }
            });

            // Handle mobile-specific events
            urlInput.addEventListener('change', (e) => {
                const url = e.target.value.trim();
                if (url && (!nameInput.value || nameInput.value === url)) {
                    instantFetch(url);
                }
            });

            // Handle focus events
            urlInput.addEventListener('focus', () => {
                if (!isFetching) {
                    loadingIndicator.style.display = 'none';
                }
            });

            // Utility function for debouncing
            function debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => {
                        clearTimeout(timeout);
                        func(...args);
                    };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }
        }

        function closeBookmarkModal() {
            const modal = document.getElementById('addBookmarkModal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
                document.getElementById('bookmarkName').value = '';
                document.getElementById('bookmarkUrl').value = '';
                document.getElementById('bookmarkDesc').value = '';
                currentSectionId = null;
                document.body.classList.remove('modal-open');
            }, 300);
        }

        function openSectionModal() {
            const modal = document.getElementById('addSectionModal');
            modal.style.display = 'flex';
            // Force reflow to ensure transition starts from initial state
            modal.offsetHeight;
            modal.classList.add('show');
            document.body.classList.add('modal-open');
            document.getElementById('sectionName').focus();
        }

        function closeSectionModal() {
            const modal = document.getElementById('addSectionModal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
                document.getElementById('sectionName').value = '';
                document.body.classList.remove('modal-open');
            }, 300);
        }

        function closeRenameModal() {
            const modal = document.getElementById('renameSectionModal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
                document.getElementById('newSectionName').value = '';
                currentRenameId = null;
                document.body.classList.remove('modal-open');
            }, 300);
        }

        // Styled alert and confirm functions
        function showAlert(title, message) {
            const modal = document.getElementById('alertModal');
            const titleEl = document.getElementById('alertTitle');
            const messageEl = document.getElementById('alertMessage');
            
            titleEl.textContent = title;
            messageEl.textContent = message;
            
            modal.style.display = 'flex';
            // Force reflow to ensure transition starts from initial state
            modal.offsetHeight;
            modal.classList.add('show');
            document.body.classList.add('modal-open');
        }

        function closeAlertModal() {
            const modal = document.getElementById('alertModal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
                document.body.classList.remove('modal-open');
            }, 300);
        }

        function showConfirm(title, message, onConfirm) {
            const modal = document.getElementById('confirmModal');
            const titleEl = document.getElementById('confirmTitle');
            const messageEl = document.getElementById('confirmMessage');
            const confirmBtn = document.getElementById('confirmButton');
            const cancelBtn = modal.querySelector('.cancel');
            
            titleEl.textContent = title;
            messageEl.textContent = message;
            
            // Prevent event bubbling to avoid bookmark navigation
            const preventBubbling = (e) => {
                e.stopPropagation();
                e.preventDefault();
            };
            
            // Set up confirm button action
            confirmBtn.onclick = (e) => {
                preventBubbling(e);
                closeConfirmModal();
                onConfirm();
            };
            
            // Set up cancel button action
            cancelBtn.onclick = (e) => {
                preventBubbling(e);
                closeConfirmModal();
            };
            
            modal.style.display = 'flex';
            // Force reflow to ensure transition starts from initial state
            modal.offsetHeight;
            modal.classList.add('show');
            document.body.classList.add('modal-open');
        }

        function closeConfirmModal() {
            const modal = document.getElementById('confirmModal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
                document.body.classList.remove('modal-open');
            }, 300);
        }

        // Language Menu Functionality
        const languageBtn = document.getElementById('languageBtn');
        const languageDropdown = document.getElementById('languageDropdown');
        let languageOpen = false;
        
        languageBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            languageOpen = !languageOpen;
            toggleDropdown(languageDropdown, languageOpen);
            
            // Close other dropdown
            if (languageOpen) {
                toggleDropdown(searchEngineDropdown, false);
                searchEngineOpen = false;
            }
        });

        // Enhanced close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.search-selector') && !e.target.closest('.language-menu')) {
                toggleDropdown(searchEngineDropdown, false);
                toggleDropdown(languageDropdown, false);
                searchEngineOpen = false;
                languageOpen = false;
            }
        });

        // Translations dictionary
        const translations = {
            de: {
                logo: "Zanes Startseite",
                searchPlaceholder: "Suchbegriff eingeben...",
                searchButton: "Suchen",
                addSection: "+ Neuen Bereich hinzufügen",
                addBookmarkTitle: "Neues Lesezeichen hinzufügen",
                bookmarkName: "Name der Website",
                bookmarkUrl: "https://example.com",
                bookmarkDesc: "Kurze Beschreibung",
                cancel: "Abbrechen",
                add: "Hinzufügen",
                createSection: "Neuen Bereich erstellen",
                sectionName: "Name des Bereichs",
                create: "Erstellen",
                renameSection: "Bereich umbenennen",
                newName: "Neuer Name",
                rename: "Umbenennen",
                deleteConfirm: "Bereich wirklich löschen? Alle Lesezeichen gehen verloren!",
                deleteBookmarkConfirm: "Lesezeichen wirklich entfernen?",
                defaultSection: "Meine Lesezeichen",
                additionalSection: "Weitere Lesezeichen",
                addBookmarkBtn: "Hinzufügen",
                editBtn: "✏️",
                deleteBtn: "🗑️",
                moreBtn: "Mehr",
                editPrompt: "Klicken Sie zum Bearbeiten",
                deletePrompt: "Klicken Sie zum Löschen",
                editWarning: "Achtung: Änderungen können nicht rückgängig gemacht werden",
                deleteWarning: "Achtung: Dieser Vorgang kann nicht rückgängig gemacht werden",
                sectionNameRequired: "Bitte einen Namen eingeben!",
                bookmarkRequired: "Bitte Name und URL eingeben!",
                githubDesc: "Code-Repository",
                googleTranslateDesc: "Übersetzungsdienst",
                bilibiliDesc: "Video-Community",
                youtubeDesc: "Video-Plattform",
                typewriterPhrases: [
                    "Zanes Startseite",
                    "Jeder Tag ist ein neuer Commit.",
                    "Nur wer sich traut, kann sich verändern.",
                    "Nicht jeder Fehler ist ein Rückschritt."
                ]
            },
            en: {
                logo: "Zane's Startpage",
                searchPlaceholder: "Enter search term...",
                searchButton: "Search",
                addSection: "+ Add New Section",
                addBookmarkTitle: "Add New Bookmark",
                bookmarkName: "Website Name",
                bookmarkUrl: "https://example.com",
                bookmarkDesc: "Short Description",
                cancel: "Cancel",
                add: "Add",
                createSection: "Create New Section",
                sectionName: "Section Name",
                create: "Create",
                renameSection: "Rename Section",
                newName: "New Name",
                rename: "Rename",
                deleteConfirm: "Really delete section? All bookmarks will be lost!",
                deleteBookmarkConfirm: "Really remove bookmark?",
                defaultSection: "My Bookmarks",
                additionalSection: "Additional Bookmarks",
                addBookmarkBtn: "Add",
                editBtn: "✏️",
                deleteBtn: "🗑️",
                moreBtn: "More",
                editPrompt: "Click to edit",
                deletePrompt: "Click to delete",
                editWarning: "Warning: Changes cannot be undone",
                deleteWarning: "Warning: This action cannot be undone",
                sectionNameRequired: "Please enter a name!",
                bookmarkRequired: "Please enter name and URL!",
                githubDesc: "Code repository",
                googleTranslateDesc: "Translation service",
                bilibiliDesc: "Video community",
                youtubeDesc: "Video platform",
                typewriterPhrases: [
                    "Zane's Startpage",
                    "Every day is a new commit.",
                    "Only those who dare can change.",
                    "Not every error is a setback."
                ]
            },
            nl: {
                logo: "Zane's Startpagina",
                searchPlaceholder: "Zoekterm invoeren...",
                searchButton: "Zoeken",
                addSection: "+ Nieuwe sectie toevoegen",
                addBookmarkTitle: "Nieuw bladwijzer toevoegen",
                bookmarkName: "Website naam",
                bookmarkUrl: "https://voorbeeld.com",
                bookmarkDesc: "Korte beschrijving",
                cancel: "Annuleren",
                add: "Toevoegen",
                createSection: "Nieuwe sectie maken",
                sectionName: "Sectienaam",
                create: "Maken",
                renameSection: "Sectie hernoemen",
                newName: "Nieuwe naam",
                rename: "Hernoemen",
                deleteConfirm: "Sectie echt verwijderen? Alle bladwijzers gaan verloren!",
                deleteBookmarkConfirm: "Bladwijzer echt verwijderen?",
                defaultSection: "Mijn bladwijzers",
                additionalSection: "Extra bladwijzers",
                addBookmarkBtn: "Toevoegen",
                editBtn: "✏️",
                deleteBtn: "🗑️",
                moreBtn: "Meer",
                editPrompt: "Klik om te bewerken",
                deletePrompt: "Klik om te verwijderen",
                editWarning: "Waarschuwing: Wijzigingen kunnen niet ongedaan worden gemaakt",
                deleteWarning: "Waarschuwing: Deze actie kan niet ongedaan worden gemaakt",
                sectionNameRequired: "Voer een naam in!",
                bookmarkRequired: "Voer naam en URL in!",
                githubDesc: "Code-repository",
                googleTranslateDesc: "Vertaaldienst",
                bilibiliDesc: "Videogemeenschap",
                youtubeDesc: "Videoplatform",
                typewriterPhrases: [
                    "Zane's Startpagina",
                    "Elke dag is een nieuwe commit",
                    "Alleen wie durft, kan veranderen",
                    "Niet elke fout is een tegenslag"
                ]
            },
            gsw: {
                logo: "Zanes Startsiite",
                searchPlaceholder: "Suchbegriff iigäh...",
                searchButton: "Sueche",
                addSection: "+ Neue Bereich zuefüege",
                addBookmarkTitle: "Neus Lesezeiche zuefüege",
                bookmarkName: "Name vo de Website",
                bookmarkUrl: "https://biispiel.com",
                bookmarkDesc: "Churzi Beschriibig",
                cancel: "Abbreche",
                add: "Zuefüege",
                createSection: "Neue Bereich erstelle",
                sectionName: "Name vom Bereich",
                create: "Erstelle",
                renameSection: "Bereich umbenenne",
                newName: "Neue Name",
                rename: "Umbennene",
                deleteConfirm: "Bereich würkli lösche? Alli Lesezeiche gönd verlore!",
                deleteBookmarkConfirm: "Lesezeiche würkli entferne?",
                defaultSection: "Mini Lesezeiche",
                additionalSection: "Wyteri Lesezeiche",
                addBookmarkBtn: "Zuefüege",
                editBtn: "✏️",
                deleteBtn: "🗑️",
                moreBtn: "Meh",
                editPrompt: "Klick zum Bearbeite",
                deletePrompt: "Klick zum Lösche",
                editWarning: "Achtig: Änderige chönd nid rückgängig gmacht werde",
                deleteWarning: "Achtig: De Vorgang cha nid rückgängig gmacht werde",
                sectionNameRequired: "Bitte gib en Name i!",
                bookmarkRequired: "Bitte gib Name und URL i!",
                githubDesc: "Code-Repository",
                googleTranslateDesc: "Übersetzigsdienst",
                bilibiliDesc: "Video-Gmeinschaft",
                youtubeDesc: "Video-Plattform",
                typewriterPhrases: [
                    "Zanes Startsiite",
                    "Jede Tag isch en neue Commit",
                    "Nur wer sich traut, cha sich verändere",
                    "Nid jede Fehler isch es Zrugg"
                ]
            },
            fi: {
                logo: "Zanen Aloitussivu",
                searchPlaceholder: "Kirjoita hakusana...",
                searchButton: "Hae",
                addSection: "+ Lisää uusi osio",
                addBookmarkTitle: "Lisää uusi kirjanmerkki",
                bookmarkName: "Verkkosivun nimi",
                bookmarkUrl: "https://esimerkki.com",
                bookmarkDesc: "Lyhyt kuvaus",
                cancel: "Peruuta",
                add: "Lisää",
                createSection: "Luo uusi osio",
                sectionName: "Osion nimi",
                create: "Luo",
                renameSection: "Nimeä osio uudelleen",
                newName: "Uusi nimi",
                rename: "Nimeä uudelleen",
                deleteConfirm: "Haluatko varmasti poistaa osion? Kaikki kirjanmerkit katoavat!",
                deleteBookmarkConfirm: "Haluatko varmasti poistaa kirjanmerkin?",
                defaultSection: "Omat kirjanmerkit",
                additionalSection: "Lisäkirjanmerkit",
                addBookmarkBtn: "Lisää",
                editBtn: "✏️",
                deleteBtn: "🗑️",
                moreBtn: "Lisää",
                editPrompt: "Klikkaa muokataksesi",
                deletePrompt: "Klikkaa poistaaksesi",
                editWarning: "Varoitus: Muutoksia ei voi perua",
                deleteWarning: "Varoitus: Tätä toimintoa ei voi perua",
                sectionNameRequired: "Anna nimi!",
                bookmarkRequired: "Anna nimi ja URL!",
                githubDesc: "Koodivarasto",
                googleTranslateDesc: "Käännöspalvelu",
                bilibiliDesc: "Videoyhteisö",
                youtubeDesc: "Videopalvelu",
                typewriterPhrases: [
                    "Zanen Aloitussivu",
                    "Jokainen päivä on uusi commit",
                    "Vain ne, jotka uskaltavat, voivat muuttua",
                    "Ei jokainen virhe ole takapakki"
                ]
            },
            fr: {
                logo: "Page d'accueil de Zane",
                searchPlaceholder: "Entrez un terme de recherche...",
                searchButton: "Rechercher",
                addSection: "+ Ajouter une nouvelle section",
                addBookmarkTitle: "Ajouter un nouveau favori",
                bookmarkName: "Nom du site web",
                bookmarkUrl: "https://exemple.com",
                bookmarkDesc: "Brève description",
                cancel: "Annuler",
                add: "Ajouter",
                createSection: "Créer une nouvelle section",
                sectionName: "Nom de la section",
                create: "Créer",
                renameSection: "Renommer la section",
                newName: "Nouveau nom",
                rename: "Renommer",
                deleteConfirm: "Voulez-vous vraiment supprimer cette section? Tous les favoris seront perdus!",
                deleteBookmarkConfirm: "Voulez-vous vraiment supprimer ce favori?",
                defaultSection: "Mes favoris",
                additionalSection: "Favoris supplémentaires",
                addBookmarkBtn: "Ajouter",
                editBtn: "✏️",
                deleteBtn: "🗑️",
                moreBtn: "Plus",
                editPrompt: "Cliquez pour modifier",
                deletePrompt: "Cliquez pour supprimer",
                editWarning: "Attention: Les modifications ne peuvent pas être annulées",
                deleteWarning: "Attention: Cette action ne peut pas être annulée",
                sectionNameRequired: "Veuillez entrer un nom!",
                bookmarkRequired: "Veuillez entrer le nom et l'URL!",
                githubDesc: "Dépôt de code",
                googleTranslateDesc: "Service de traduction",
                bilibiliDesc: "Communauté vidéo",
                youtubeDesc: "Plateforme vidéo",
                typewriterPhrases: [
                    "Page d'accueil de Zane",
                    "Chaque jour est un nouveau commit",
                    "Seuls ceux qui osent peuvent changer",
                    "Chaque erreur n'est pas un échec"
                ]
            },
            zh: {
                logo: "Zane的标签页",
                searchPlaceholder: "输入搜索词...",
                searchButton: "搜索",
                addSection: "+ 添加新分区",
                addBookmarkTitle: "添加新书签",
                bookmarkName: "网站名称",
                bookmarkUrl: "https://example.com",
                bookmarkDesc: "简短描述",
                cancel: "取消",
                add: "添加",
                createSection: "创建新分区",
                sectionName: "分区名称",
                create: "创建",
                renameSection: "重命名分区",
                newName: "新名称",
                rename: "重命名",
                deleteConfirm: "确定删除分区吗？所有书签都将丢失！",
                deleteBookmarkConfirm: "确定删除书签吗？",
                defaultSection: "我的书签",
                additionalSection: "其他书签",
                addBookmarkBtn: "添加",
                editBtn: "✏️",
                deleteBtn: "🗑️",
                moreBtn: "更多",
                editPrompt: "点击编辑",
                deletePrompt: "点击删除",
                editWarning: "警告：更改无法撤销",
                deleteWarning: "警告：此操作无法撤销",
                sectionNameRequired: "请输入名称！",
                bookmarkRequired: "请输入名称和URL！",
                githubDesc: "代码仓库",
                googleTranslateDesc: "翻译服务",
                bilibiliDesc: "视频社区",
                youtubeDesc: "视频平台",
                typewriterPhrases: [
                    "Zane的标签页",
                    "「苟日新，日日新」",
                    "「变者非疵，实乃天工」",
                    "「过者非退，或跃在渊」"
                ]
            },
            ja: {
                logo: "Zaneのスタートページ",
                searchPlaceholder: "検索語を入力...",
                searchButton: "検索",
                addSection: "+ 新しいセクションを追加",
                addBookmarkTitle: "新しいブックマークを追加",
                bookmarkName: "ウェブサイト名",
                bookmarkUrl: "https://example.com",
                bookmarkDesc: "簡単な説明",
                cancel: "キャンセル",
                add: "追加",
                createSection: "新しいセクションを作成",
                sectionName: "セクション名",
                create: "作成",
                renameSection: "セクション名を変更",
                newName: "新しい名前",
                rename: "名前変更",
                deleteConfirm: "セクションを本当に削除しますか？すべてのブックマークが失われます！",
                deleteBookmarkConfirm: "ブックマークを本当に削除しますか？",
                defaultSection: "マイブックマーク",
                additionalSection: "追加のブックマーク",
                addBookmarkBtn: "追加",
                editBtn: "✏️",
                deleteBtn: "🗑️",
                moreBtn: "もっと",
                editPrompt: "クリックして編集",
                deletePrompt: "クリックして削除",
                editWarning: "警告：変更は元に戻せません",
                deleteWarning: "警告：この操作は元に戻せません",
                sectionNameRequired: "名前を入力してください！",
                bookmarkRequired: "名前とURLを入力してください！",
                githubDesc: "コードリポジトリ",
                googleTranslateDesc: "翻訳サービス",
                bilibiliDesc: "動画コミュニティ",
                youtubeDesc: "動画プラットフォーム",
                typewriterPhrases: [
                    "Zaneのスタートページ",
                    "「日々是新たなコミット」",
                    "「変化は不具合ではなく、仕様です」",
                    "「エラーもまた、進化の一歩」"
                ]
            }
        };

        // Current language - check localStorage first, default to German for first visit
        let currentLanguage = localStorage.getItem('zane-language') || 'de';
        
        // Ensure German is set as default for first-time visitors
        if (!localStorage.getItem('zane-language')) {
            localStorage.setItem('zane-language', 'de');
            document.documentElement.lang = 'de';
        }

        // Language selection handler
        document.querySelectorAll('.language-option').forEach(option => {
            option.addEventListener('click', (e) => {
                e.stopPropagation();
                const lang = e.target.getAttribute('data-lang');
                if (lang) {
                    currentLanguage = lang;
                    localStorage.setItem('zane-language', lang);
                    document.documentElement.lang = lang;
                    
                    // Force immediate UI update
                    updateUIText();
                    
                    // Close dropdown
                    toggleDropdown(languageDropdown, false);
                    languageOpen = false;
                }
            });
        });

        // Update bookmark descriptions for default bookmarks when language changes
        function updateBookmarkDescriptions() {
            const langData = translations[currentLanguage] || translations.de;
            
            // Find the main section
            const mainSection = bookmarkSections.find(s => s.id === 'main');
            if (mainSection && mainSection.isDefault) {
                // Update descriptions for default bookmarks
                mainSection.bookmarks.forEach(bookmark => {
                    if (bookmark.name === 'GitHub') {
                        bookmark.desc = langData.githubDesc;
                    } else if (bookmark.name === 'Google Translate') {
                        bookmark.desc = langData.googleTranslateDesc;
                    } else if (bookmark.name === 'Bilibili') {
                        bookmark.desc = langData.bilibiliDesc;
                    } else if (bookmark.name === 'YouTube') {
                        bookmark.desc = langData.youtubeDesc;
                    }
                });
                saveSections();
            }
        }

        // Update all UI text elements
        function updateUIText() {
            const langData = translations[currentLanguage] || translations.de;
            
            // Update logo - handled by typewriter animation
            
            // Update search elements
            document.getElementById('searchInput').placeholder = langData.searchPlaceholder;
            document.querySelector('.search-button .search-text').textContent = langData.searchButton;
            
            // Update section buttons
            document.getElementById('addSectionBtn').textContent = langData.addSection;
            
            // Update language button
            document.getElementById('languageBtn').textContent = langData.moreBtn;
            
            // Update modal texts
            document.querySelector('#addBookmarkModal h3').textContent = langData.addBookmarkTitle;
            document.querySelector('#addSectionModal h3').textContent = langData.createSection;
            document.querySelector('#renameSectionModal h3').textContent = langData.renameSection;
            
            // Update button texts
            document.querySelectorAll('.cancel').forEach(btn => {
                btn.textContent = langData.cancel;
            });
            document.querySelector('#addBookmarkModal button:not(.cancel)').textContent = langData.add;
            document.querySelector('#addSectionModal button:not(.cancel)').textContent = langData.create;
            document.querySelector('#renameSectionModal button:not(.cancel)').textContent = langData.rename;
            
            // Update placeholders
            document.getElementById('bookmarkName').placeholder = langData.bookmarkName;
            document.getElementById('bookmarkUrl').placeholder = 'https://example.com';
            document.getElementById('bookmarkDesc').placeholder = langData.bookmarkDesc;
            document.getElementById('sectionName').placeholder = langData.sectionName;
            document.getElementById('newSectionName').placeholder = langData.newName;
            
            // Update section names for default sections (only if they exist)
            const mainSection = bookmarkSections.find(s => s.id === 'main');
            if (mainSection && mainSection.isDefault) {
                mainSection.name = langData.defaultSection;
            }
            
            const additionalSection = bookmarkSections.find(s => s.id === 'additional');
            if (additionalSection && additionalSection.isDefault === false) {
                additionalSection.name = langData.additionalSection;
            }
            
            // Update bookmark descriptions for default bookmarks
            updateBookmarkDescriptions();
            
            // Update search engine display for language change
            updateSearchEngineDisplay();
            
            // Re-render sections to update all text
            renderSections();
            
            // Restart typewriter animation with new language
            if (typewriterAnimation) {
                typewriterAnimation.stop();
                typewriterAnimation.start();
            }
        }

        // Typewriter Animation Class
        class TypewriterAnimation {
            constructor(element) {
                this.element = element;
                this.currentPhraseIndex = 0;
                this.currentText = '';
                this.isDeleting = false;
                this.isPaused = false;
                this.typeSpeed = 100;
                this.deleteSpeed = 50;
                this.pauseTime = 2000;
                this.animationId = null;
                this.init();
            }

            init() {
                this.element.innerHTML = '';
                
                const textSpan = document.createElement('span');
                textSpan.className = 'typewriter-text';
                this.element.appendChild(textSpan);
                
                this.cursorElement = document.createElement('span');
                this.cursorElement.className = 'typewriter-cursor';
                this.element.appendChild(this.cursorElement);
                
                this.textElement = textSpan;
            }

            type() {
                if (this.isPaused) return;

                const phrases = translations[currentLanguage]?.typewriterPhrases || translations.de.typewriterPhrases;
                const current = phrases[this.currentPhraseIndex];
                
                if (this.isDeleting) {
                    this.currentText = current.substring(0, this.currentText.length - 1);
                    this.textElement.textContent = this.currentText;
                    
                    if (this.currentText === '') {
                        this.isDeleting = false;
                        this.currentPhraseIndex = (this.currentPhraseIndex + 1) % phrases.length;
                        this.animationId = setTimeout(() => this.type(), 1000); // 1 second pause between sentences
                    } else {
                        this.animationId = setTimeout(() => this.type(), this.deleteSpeed);
                    }
                } else {
                    this.currentText = current.substring(0, this.currentText.length + 1);
                    this.textElement.textContent = this.currentText;
                    
                    if (this.currentText === current) {
                        this.isPaused = true;
                        this.animationId = setTimeout(() => {
                            this.isPaused = false;
                            this.isDeleting = true;
                            this.type();
                        }, this.pauseTime);
                    } else {
                        this.animationId = setTimeout(() => this.type(), this.typeSpeed);
                    }
                }
            }

            start() {
                this.stop();
                this.currentPhraseIndex = 0;
                this.currentText = '';
                this.isDeleting = false;
                this.isPaused = false;
                this.init();
                this.type();
            }

            stop() {
                if (this.animationId) {
                    clearTimeout(this.animationId);
                    this.animationId = null;
                }
                this.isPaused = true;
            }

            restart() {
                this.start();
            }
        }

        let typewriterAnimation;

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            const addSectionBtn = document.getElementById('addSectionBtn');
            if (addSectionBtn) {
                addSectionBtn.addEventListener('click', openSectionModal);
            }
            
            // Initialize typewriter animation
            const logoElement = document.getElementById('typewriterLogo');
            if (logoElement) {
                typewriterAnimation = new TypewriterAnimation(logoElement);
                typewriterAnimation.start();
            }
            
            // Setup title fetching for bookmark modal
            setupTitleFetching();
            
            // Modal click-outside-to-close
            document.getElementById('addBookmarkModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeBookmarkModal();
                }
            });
    
            document.getElementById('addSectionModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeSectionModal();
                }
            });
    
            document.getElementById('renameSectionModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeRenameModal();
                }
            });
    
            document.getElementById('alertModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeAlertModal();
                }
            });
    
            document.getElementById('confirmModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeConfirmModal();
                }
            });
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Check if any modal is open
            const isModalOpen = document.querySelector('.modal.show') !== null;
            
            // Only capture '/' for search if no modal is open and not already focused on search
            if (e.key === '/' && e.target !== searchInput && !isModalOpen) {
                e.preventDefault();
                searchInput.focus();
            }
            
            // Escape key closes all modals
            if (e.key === 'Escape') {
                closeBookmarkModal();
                closeSectionModal();
                closeRenameModal();
                closeAlertModal();
                closeConfirmModal();
            }
        });

        // Prevent modal inputs from triggering global keyboard shortcuts
        document.addEventListener('DOMContentLoaded', function() {
            // Add event listeners to all modal inputs
            const modalInputs = document.querySelectorAll('.modal input');
            modalInputs.forEach(input => {
                input.addEventListener('keydown', function(e) {
                    // Stop propagation to prevent global shortcuts
                    e.stopPropagation();
                    
                    // Allow normal typing including '/'
                    if (e.key === 'Escape') {
                        // Close the modal when Escape is pressed in any input
                        const modal = this.closest('.modal');
                        if (modal) {
                            const modalId = modal.id;
                            if (modalId === 'addBookmarkModal') closeBookmarkModal();
                            else if (modalId === 'addSectionModal') closeSectionModal();
                            else if (modalId === 'renameSectionModal') closeRenameModal();
                            else if (modalId === 'alertModal') closeAlertModal();
                            else if (modalId === 'confirmModal') closeConfirmModal();
                        }
                    }
                });
            });
        });

        // Enhanced Dropdown Animations
        function toggleDropdown(dropdown, show) {
            if (show) {
                dropdown.style.display = 'block';
                // Force reflow to ensure transition starts from correct state
                dropdown.offsetHeight;
                dropdown.classList.add('show');
            } else {
                dropdown.classList.remove('show');
                setTimeout(() => {
                    dropdown.style.display = 'none';
                }, 400); // Match transition duration
            }
        }

        // Search Engine Dropdown Functionality
        const searchEngineDropdown = document.getElementById('searchEngineDropdown');
        let searchEngineOpen = false;
        
        searchEngineBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            searchEngineOpen = !searchEngineOpen;
            toggleDropdown(searchEngineDropdown, searchEngineOpen);
            
            // Close other dropdown
            if (searchEngineOpen) {
                toggleDropdown(languageDropdown, false);
                languageOpen = false;
            }
        });

        // Handle engine selection
        document.querySelectorAll('.search-engine-option').forEach(option => {
            option.addEventListener('click', (e) => {
                const engine = e.target.getAttribute('data-engine');
                saveSearchEngine(engine);
                searchEngineBtn.textContent = getEngineDisplayName(engine);
                toggleDropdown(searchEngineDropdown, false);
                searchEngineOpen = false;
            });
        });

        // Initialize
        // Set language from localStorage before any rendering
        const savedLanguage = localStorage.getItem('zane-language');
        if (savedLanguage && translations[savedLanguage]) {
            currentLanguage = savedLanguage;
            document.documentElement.lang = savedLanguage;
        }
        
        // Load saved search engine
        loadSearchEngine();
        
        // Apply language immediately
        updateUIText();
        
        searchInput.focus();
        createParticles();
        loadSections();

        // Remove the conflicting touch handler - it's now handled by the drag system
    </script>



</body></html>
